<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>9. Vue.js的vue-router库 &mdash; 运维开发修炼之路</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="10. Vue.js的状态管理库Vuex和Pinia" href="10.Vue.js%E7%9A%84%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E5%BA%93Vuex%E5%92%8CPinia.html" />
    <link rel="prev" title="8. Vue.js的组件化" href="08.Vue.js%E7%9A%84%E7%BB%84%E4%BB%B6%E5%8C%96.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> 小健_Python_go_Devops
            <img src="../_static/python_go.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Go/index.html">Go语言学习</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Go_vs_Python/index.html">Go vs Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Python/index.html">Python全栈系列</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Python%E6%B5%8B%E8%AF%95%E5%BC%80%E5%8F%91%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%9E%E8%B7%B5/index.html">Python测试开发入门与实践</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Vue/index.html">Vue.js企业开发实战</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Vue.js+Node.js开发实战</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="01.%E5%BC%80%E5%8F%91%E4%B8%80%E4%B8%AA%E7%BD%91%E7%AB%99%E7%9A%84%E5%87%86%E5%A4%87.html">1. 开发一个网站的准备</a></li>
<li class="toctree-l2"><a class="reference internal" href="02.Nodejs_vue%E5%9F%BA%E7%A1%80.html">2. Nodejs+vue基础</a></li>
<li class="toctree-l2"><a class="reference internal" href="03.%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E5%87%86%E5%A4%87.html">3. 项目开发准备</a></li>
<li class="toctree-l2"><a class="reference internal" href="04.%E9%A1%B9%E7%9B%AE%E5%90%8E%E5%8F%B0%E6%8A%80%E6%9C%AFExpress.html">4. 项目后台技术Express</a></li>
<li class="toctree-l2"><a class="reference internal" href="05.Vue.js%E5%BC%80%E5%8F%91%E5%9F%BA%E7%A1%80.html">5. Vue.js开发基础</a></li>
<li class="toctree-l2"><a class="reference internal" href="06.Vue.js%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F.html">6. Vue的生命周期</a></li>
<li class="toctree-l2"><a class="reference internal" href="07.Vue.js%E7%9A%84%E6%A8%A1%E6%9D%BF%E8%AF%AD%E6%B3%95.html">7. Vue.js的模板语法</a></li>
<li class="toctree-l2"><a class="reference internal" href="08.Vue.js%E7%9A%84%E7%BB%84%E4%BB%B6%E5%8C%96.html">8. Vue.js的组件化</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">9. Vue.js的vue-router库</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#vue-js">9.1. 1.Vue.js的页面路由实现</a></li>
<li class="toctree-l3"><a class="reference internal" href="#vue-clivue-js">9.2. 2. 使用vue-cli初始化Vue.js项目</a></li>
<li class="toctree-l3"><a class="reference internal" href="#vue-router">9.3. 3. 安装和配置vue-router</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id1">9.4. 4. 动态路由匹配</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">9.5. 5. 路由嵌套</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">9.6. 6. 路由跳转</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">9.7. 7. 导航守卫</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="10.Vue.js%E7%9A%84%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E5%BA%93Vuex%E5%92%8CPinia.html">10. Vue.js的状态管理库Vuex和Pinia</a></li>
<li class="toctree-l2"><a class="reference internal" href="11.Vue-UI%E5%BA%93.html">11. Vue-UI库</a></li>
<li class="toctree-l2"><a class="reference internal" href="12.%E9%A1%B9%E7%9B%AE%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E5%92%8C%E5%8A%9F%E8%83%BD%E8%AF%B4%E6%98%8E.html">12. 项目需求分析和功能说明</a></li>
<li class="toctree-l2"><a class="reference internal" href="13.%E9%A1%B9%E7%9B%AE%E7%AD%96%E5%88%92%E5%92%8C%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1.html">13. 项目策划和功能设计</a></li>
<li class="toctree-l2"><a class="reference internal" href="14.%E9%A1%B9%E7%9B%AE%E5%90%8E%E7%AB%AFAPI%E5%BC%80%E5%8F%91.html">14. 项目后端API开发</a></li>
<li class="toctree-l2"><a class="reference internal" href="15.%E9%80%9A%E7%94%A8API%E5%BC%80%E5%8F%91.html">15. 通用API开发</a></li>
<li class="toctree-l2"><a class="reference internal" href="16.%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90%E7%9B%B8%E5%85%B3API%E5%BC%80%E5%8F%91.html">16. 用户权限相关API开发</a></li>
<li class="toctree-l2"><a class="reference internal" href="17.%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%9B%B8%E5%85%B3API%E5%BC%80%E5%8F%91.html">17. 后台管理相关API开发</a></li>
<li class="toctree-l2"><a class="reference internal" href="18.%E5%B0%8F%E7%BB%93.html">18. 小结</a></li>
<li class="toctree-l2"><a class="reference internal" href="19.%E5%89%8D%E7%AB%AF%E9%A1%B5%E9%9D%A2%E5%BC%80%E5%8F%91.html">19. 前端页面开发</a></li>
<li class="toctree-l2"><a class="reference internal" href="20.%E4%B8%BB%E8%A6%81%E9%A1%B5%E9%9D%A2%E7%9A%84%E5%BC%80%E5%8F%91.html">20. 主要页面的开发</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">小健_Python_go_Devops</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Vue.js+Node.js开发实战</a> &raquo;</li>
      <li><span class="section-number">9. </span>Vue.js的vue-router库</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/Vue_Node.js/09.Vue.js的vue-router库.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#vue-jsvue-router" id="id5">Vue.js的vue-router库</a></p>
<ul>
<li><p><a class="reference internal" href="#vue-js" id="id6">1.Vue.js的页面路由实现</a></p></li>
<li><p><a class="reference internal" href="#vue-clivue-js" id="id7">2. 使用vue-cli初始化Vue.js项目</a></p></li>
<li><p><a class="reference internal" href="#vue-router" id="id8">3. 安装和配置vue-router</a></p></li>
<li><p><a class="reference internal" href="#id1" id="id9">4. 动态路由匹配</a></p></li>
<li><p><a class="reference internal" href="#id2" id="id10">5. 路由嵌套</a></p></li>
<li><p><a class="reference internal" href="#id3" id="id11">6. 路由跳转</a></p></li>
<li><p><a class="reference internal" href="#id4" id="id12">7. 导航守卫</a></p></li>
</ul>
</li>
</ul>
</div>
<section id="vue-jsvue-router">
<h1><a class="toc-backref" href="#id5"><span class="section-number">9. </span>Vue.js的vue-router库</a><a class="headerlink" href="#vue-jsvue-router" title="Permalink to this headline">¶</a></h1>
<section id="vue-js">
<h2><a class="toc-backref" href="#id6"><span class="section-number">9.1. </span>1.Vue.js的页面路由实现</a><a class="headerlink" href="#vue-js" title="Permalink to this headline">¶</a></h2>
<p>Vue.js是对前端技术的革新，是为了提升传统HTML中DOM节点的性能而出现的技术，它和React.js框架一样，都是为了让单页面应用能够极速地载入和响应。</p>
<p>现代的浏览器为开发者提供了一个可以使用的“操作系统”，各类网页本身就是浏览器中的应用。这类应用实现了打开即用，能达到和本地应用一样的性能和用户体验。</p>
<p>这种体验归功于前端技术的不断改进。也就是说，Vue.js和React.js等框架打造了新时代的网页“应用（App）”。</p>
<p>Vue.js使用虚拟DOM处理单页面，然后使用Webpack打包。</p>
<p>通过之前的示例，读者也许已经发现，无论语法和写法如何不同，Vue.js程序打包后都是一个单一的HTML文件，同时会引入一个标准的JavaScript文件。</p>
<p>也就是说，Vue.js中编写的所有代码都被Webpack自动打包成可以被浏览器解析的HTML和JavaScript代码，并且项目本身就只有一个页面。</p>
<p>这意味着所有的用户对服务器发出进入页面的请求时，只会对服务器发出一次请求。</p>
<blockquote>
<div><p>注意：一个应用只有一个页面是不切实际的，将所有功能堆积在一个页面中，不仅影响用户体验，还影响开发的效率（大量代码叠加在一起）。</p>
</div></blockquote>
<p>传统的HTML网页应用如果进行页面跳转，会根据网页地址（URL）来刷新页面，在网速极大提高的今天，这类跳转仍会不可避免地出现“白屏”现象，</p>
<p>这显然不是Vue.js单页面应用想要的效果。而应用本身又需要URL来控制页面，在这种情况下，Vue.js提供了vue-router来实现页面跳转。</p>
<p>vue-router提供了两种模式模拟URL：hash模式和history模式。</p>
<p>（1）hash模式是默认模式，使用网页的URL模拟一个完整的URL，当URL改变时，重新获取hash对应的页面（在Vue.js中是需要显示的组件），并将这些内容显示在页面中，这样模拟的URL不会让整个页面重新加载。也就是说，页面只在首次加载时刷新。这样就在无刷新的情况下，通过控制组件的显示，完成页面的切换。</p>
<p>vue-router如果采用默认的hash模式，会自动产生“#”。</p>
<p>（2）history模式针对的是支持HTML
5新特性history的浏览器，其本身就是用户访问页面时浏览记录的堆栈，HTML
5允许操作history栈中的内容。</p>
<blockquote>
<div><p>注意：无论采用何种方式配置vue-router，Vue.js单页面应用都不会刷新页面。</p>
</div></blockquote>
</section>
<section id="vue-clivue-js">
<h2><a class="toc-backref" href="#id7"><span class="section-number">9.2. </span>2. 使用vue-cli初始化Vue.js项目</a><a class="headerlink" href="#vue-clivue-js" title="Permalink to this headline">¶</a></h2>
<p>所有的Vue.js项目都采用vue-cli（官方提供的命令行管理工具）构建，这比前面介绍的手动配置Webpack等方式要简单得多。</p>
<p>【示例】使用vue-cli配置Vue.js项目。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># 安装淘宝npm</span>
<span class="n">npm</span> <span class="n">install</span> <span class="o">-</span><span class="n">g</span> <span class="n">cnpm</span> <span class="o">--</span><span class="n">registry</span><span class="o">=</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">registry</span><span class="o">.</span><span class="n">npm</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">org</span>

<span class="c1"># vue-cli 安装依赖包</span>
<span class="n">cnpm</span> <span class="n">install</span> <span class="o">-</span><span class="n">g</span> <span class="nd">@vue</span><span class="o">/</span><span class="n">cli</span>
</pre></div>
</div>
<blockquote>
<div><p>注意：之前没有选择vue-cli构建项目的一个原因是，Webpack是大多数框架构建的通用工具，了解Webpack的配置非常重要。</p>
</div></blockquote>
<p>（2）在命令行工具中使用vue相关命令。首先使用如下命令新建一个项目，名称为router-test。</p>
<p>可参考文献：</p>
<p><a class="reference external" href="http://vue.ezops.cn/#/src/01/%E8%84%9A%E6%89%8B%E6%9E%B6">http://vue.ezops.cn/#/src/01/%E8%84%9A%E6%89%8B%E6%9E%B6</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>vue create router-test
Vue CLI v5.0.1
? Please pick a preset:
  Default ([Vue 3] babel, eslint)
  Default ([Vue 2] babel, eslint)
&gt; Manually select features          # 选择手动
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>要用到vue-router库，但项目并没有默认安装，所以应当选择配置Manually
select features，勾选该模块（通过空格键勾选）并且按Enter键确认</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">enter</span><span class="o">&gt;</span> <span class="n">to</span> <span class="n">proceed</span><span class="p">)</span>
 <span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="n">Babel</span>
 <span class="p">(</span> <span class="p">)</span> <span class="n">TypeScript</span>
 <span class="p">(</span> <span class="p">)</span> <span class="n">Progressive</span> <span class="n">Web</span> <span class="n">App</span> <span class="p">(</span><span class="n">PWA</span><span class="p">)</span> <span class="n">Support</span>
<span class="o">&gt;</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="n">Router</span>                 <span class="c1"># 勾选</span>
 <span class="p">(</span> <span class="p">)</span> <span class="n">Vuex</span>
 <span class="p">(</span> <span class="p">)</span> <span class="n">CSS</span> <span class="n">Pre</span><span class="o">-</span><span class="n">processors</span>
 <span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="n">Linter</span> <span class="o">/</span> <span class="n">Formatter</span>         <span class="c1"># 勾选</span>
 <span class="p">(</span> <span class="p">)</span> <span class="n">Unit</span> <span class="n">Testing</span>
 <span class="p">(</span> <span class="p">)</span> <span class="n">E2E</span> <span class="n">Testing</span>
</pre></div>
</div>
<p>（4）确认之后，会询问是否使用history模式，这里选择是（Y）。接下来配置EsLint等选项，可以选择默认选项。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>? Choose a version of Vue.js that you want to start the project with
  3.x
&gt; 2.x

? Use history mode for router? (Requires proper server setup for index fallback in production) Yes      # Y
? Pick a linter / formatter config: Standard
? Pick additional lint features: Lint on save
? Where do you prefer placing config for Babel, ESLint, etc.? In dedicated config files
? Save this as a preset for future projects? No
</pre></div>
</div>
<p>（5）安装完成后，可以看到，成功创建了项目。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>success Saved lockfile.
Done in 27.95s.
⚓  Running completion hooks...

📄  Generating README.md...

🎉  Successfully created project router-test.
👉  Get started with the following commands:

 $ cd router-test
 $ yarn serve
</pre></div>
</div>
<p>使用vue-cli创建了一个包含vue-router的项目，其中配置了相应的启动和构建打包指令。项目的package.json代码如下：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;router-test&quot;</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;0.1.0&quot;</span><span class="p">,</span>
  <span class="s2">&quot;private&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;scripts&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;serve&quot;</span><span class="p">:</span> <span class="s2">&quot;vue-cli-service serve&quot;</span><span class="p">,</span>
    <span class="s2">&quot;build&quot;</span><span class="p">:</span> <span class="s2">&quot;vue-cli-service build&quot;</span><span class="p">,</span>
    <span class="s2">&quot;lint&quot;</span><span class="p">:</span> <span class="s2">&quot;vue-cli-service lint&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;dependencies&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;core-js&quot;</span><span class="p">:</span> <span class="s2">&quot;^3.8.3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;vue&quot;</span><span class="p">:</span> <span class="s2">&quot;^2.6.14&quot;</span><span class="p">,</span>
    <span class="s2">&quot;vue-router&quot;</span><span class="p">:</span> <span class="s2">&quot;^3.5.1&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;devDependencies&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;@babel/core&quot;</span><span class="p">:</span> <span class="s2">&quot;^7.12.16&quot;</span><span class="p">,</span>
    <span class="s2">&quot;@babel/eslint-parser&quot;</span><span class="p">:</span> <span class="s2">&quot;^7.12.16&quot;</span><span class="p">,</span>
    <span class="s2">&quot;@vue/cli-plugin-babel&quot;</span><span class="p">:</span> <span class="s2">&quot;~5.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;@vue/cli-plugin-eslint&quot;</span><span class="p">:</span> <span class="s2">&quot;~5.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;@vue/cli-plugin-router&quot;</span><span class="p">:</span> <span class="s2">&quot;~5.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;@vue/cli-service&quot;</span><span class="p">:</span> <span class="s2">&quot;~5.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;@vue/eslint-config-standard&quot;</span><span class="p">:</span> <span class="s2">&quot;^6.1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;eslint&quot;</span><span class="p">:</span> <span class="s2">&quot;^7.32.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;eslint-plugin-import&quot;</span><span class="p">:</span> <span class="s2">&quot;^2.25.3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;eslint-plugin-node&quot;</span><span class="p">:</span> <span class="s2">&quot;^11.1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;eslint-plugin-promise&quot;</span><span class="p">:</span> <span class="s2">&quot;^5.1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;eslint-plugin-vue&quot;</span><span class="p">:</span> <span class="s2">&quot;^8.0.3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;vue-template-compiler&quot;</span><span class="p">:</span> <span class="s2">&quot;^2.6.14&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>最新版本的vue-cli提供了图形化的项目创建页面，需要通过浏览器配置项目。在命令行工具中使用如下命令启动vue-cli：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vue</span> <span class="n">ui</span>
</pre></div>
</div>
<p>上面的命令会启动一个小服务器，同时打开一个项目配置页面，如图所示，可以在其中更改已创建的项目或创建新的项目。</p>
<blockquote>
<div><p>注意：使用vue-cli构建的项目没有Webpack的相关配置，这并不意味着项目没有使用Webpack，因为vue-cli本身就是一个基于Webpack构建的Vue.js专属构建工具。</p>
</div></blockquote>
</section>
<section id="vue-router">
<h2><a class="toc-backref" href="#id8"><span class="section-number">9.3. </span>3. 安装和配置vue-router</a><a class="headerlink" href="#vue-router" title="Permalink to this headline">¶</a></h2>
<p>如果需要在现有的Vue.js项目中使用vue-router，或者在构建项目时没有添加vue-router，则需要像在Express框架中使用其他模块一样，通过npm命令安装vue-router。</p>
<p>（1）安装命令如下：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">npm</span> <span class="n">install</span> <span class="n">vue</span><span class="o">-</span><span class="n">router</span>
</pre></div>
</div>
<p>（2）安装完成后，可以直接在main.js中定义路由并引用，或编写一个单独的文件用来定义路由。笔者采用单独文件的方式，在src文件夹中新建一个文件夹并命名为router，然后定义一个JavaScript文件，命名为index.js（名称自定义即可）。代码如下：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">Vue</span> <span class="kn">from</span> <span class="s1">&#39;vue&#39;</span>
<span class="kn">import</span> <span class="nn">VueRouter</span> <span class="kn">from</span> <span class="s1">&#39;vue-router&#39;</span>
<span class="kn">import</span> <span class="nn">HomeView</span> <span class="kn">from</span> <span class="s1">&#39;../views/HomeView.vue&#39;</span>

<span class="n">Vue</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">VueRouter</span><span class="p">)</span>

<span class="n">const</span> <span class="n">routes</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="n">path</span><span class="p">:</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;home&#39;</span><span class="p">,</span>
    <span class="n">component</span><span class="p">:</span> <span class="n">HomeView</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="n">path</span><span class="p">:</span> <span class="s1">&#39;/about&#39;</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;about&#39;</span><span class="p">,</span>
    <span class="o">//</span> <span class="n">route</span> <span class="n">level</span> <span class="n">code</span><span class="o">-</span><span class="n">splitting</span>
    <span class="o">//</span> <span class="n">this</span> <span class="n">generates</span> <span class="n">a</span> <span class="n">separate</span> <span class="n">chunk</span> <span class="p">(</span><span class="n">about</span><span class="o">.</span><span class="p">[</span><span class="nb">hash</span><span class="p">]</span><span class="o">.</span><span class="n">js</span><span class="p">)</span> <span class="k">for</span> <span class="n">this</span> <span class="n">route</span>
    <span class="o">//</span> <span class="n">which</span> <span class="ow">is</span> <span class="n">lazy</span><span class="o">-</span><span class="n">loaded</span> <span class="n">when</span> <span class="n">the</span> <span class="n">route</span> <span class="ow">is</span> <span class="n">visited</span><span class="o">.</span>
    <span class="n">component</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="n">import</span><span class="p">(</span><span class="o">/*</span> <span class="n">webpackChunkName</span><span class="p">:</span> <span class="s2">&quot;about&quot;</span> <span class="o">*/</span> <span class="s1">&#39;../views/AboutView.vue&#39;</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">]</span>

<span class="n">const</span> <span class="n">router</span> <span class="o">=</span> <span class="n">new</span> <span class="n">VueRouter</span><span class="p">({</span>
  <span class="n">mode</span><span class="p">:</span> <span class="s1">&#39;history&#39;</span><span class="p">,</span>
  <span class="n">base</span><span class="p">:</span> <span class="n">process</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">BASE_URL</span><span class="p">,</span>
  <span class="n">routes</span>
<span class="p">})</span>

<span class="n">export</span> <span class="n">default</span> <span class="n">router</span>
</pre></div>
</div>
<p>该文件不仅实例化了一个VueRouter，还定义了一个名为<code class="docutils literal notranslate"><span class="pre">/</span></code>和<code class="docutils literal notranslate"><span class="pre">/about</span></code>的路由，访问该路由时会调用组件HomeView和AboutView。</p>
<p>（3）编写完router文件后再编写main.js，其中要引入router文件，然后在实例化Vue.js对象时传入。代码如下：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>import Vue from &#39;vue&#39;
import App from &#39;./App.vue&#39;
import router from &#39;./router&#39;

Vue.config.productionTip = false

new Vue({
  router,
  render: h =&gt; h(App)
}).$mount(&#39;#app&#39;)
</pre></div>
</div>
<p>（4）接着在App.vue中引入路由组件。本章前面介绍过Vue.js的路由并不是真实的页面刷新，而是对组件显示内容的切换，因此将组件添加在App.vue的统一Vue文件入口中。代码如下：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;template&gt;
  &lt;div id=&quot;app&quot;&gt;
    &lt;nav&gt;
      &lt;router-link to=&quot;/&quot;&gt;Home&lt;/router-link&gt; |
      &lt;router-link to=&quot;/about&quot;&gt;About&lt;/router-link&gt;
    &lt;/nav&gt;
&lt;!--    引入路由显示组件--&gt;
    &lt;router-view/&gt;
  &lt;/div&gt;
&lt;/template&gt;
</pre></div>
</div>
<p>因为vue-router库是全局注册，在vue-router库注册的同时其自带的组件也都是全局注册，所以不需要在页面的components中注册就可以直接使用。</p>
<blockquote>
<div><p>注意：如果在构建Vue.js项目时已经添加了vue-router库，则不需要任何配置便可以直接使用它。</p>
</div></blockquote>
</section>
<section id="id1">
<h2><a class="toc-backref" href="#id9"><span class="section-number">9.4. </span>4. 动态路由匹配</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>无论是自行安装vue-router，还是通过vue-cli命令直接构建工程，都需要保证工程能够支持路由。URL的作用除了指定页面的访问地址外，还包括路由参数的传递。在Vue.js中通过参数也能实现路由的动态匹配。例如，CMS系统（内容管理系统）中某一篇文章的路由访问路径形式如下：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://localhost/article?id=xxx
http://localhost/article/xxx
</pre></div>
</div>
<p>第一行表示以传统的参数形式进行访问，通过GET方式发送请求，并在URL之后跟随一个“?”和id参数，其中xxx为该文章的唯一ID，通过它可以查询文章本身，并且不存在二义性。</p>
<p>第二行显示的其实就是动态路由规划实现的功能，对所有以“基础网址+‘/article/’+参数”形式的路由路径统一解析在某一个处理逻辑中，路径最后跟随的信息被认为是参数而不是路径本身。</p>
<p>【示例】通过用户ID访问用户的主页。</p>
<p>首先定义路由，修改router文件夹中的index.js文件，增加相应的用户信息路由。以下是HomeIndex部分路径定义的代码：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">HomeIndex</span> <span class="kn">from</span> <span class="s1">&#39;@/views/HomeIndex&#39;</span>

<span class="n">Vue</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">VueRouter</span><span class="p">)</span>

<span class="n">const</span> <span class="n">routes</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="n">path</span><span class="p">:</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;home&#39;</span><span class="p">,</span>
    <span class="n">component</span><span class="p">:</span> <span class="n">HomeView</span>
  <span class="p">},</span>
  <span class="p">{</span>
<span class="o">.....</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="n">path</span><span class="p">:</span> <span class="s1">&#39;/user/:id&#39;</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;HomeIndex&#39;</span><span class="p">,</span>
    <span class="n">component</span><span class="p">:</span> <span class="n">HomeIndex</span>
  <span class="p">}</span>
<span class="p">]</span>

<span class="n">const</span> <span class="n">router</span> <span class="o">=</span> <span class="n">new</span> <span class="n">VueRouter</span><span class="p">({</span>
  <span class="n">mode</span><span class="p">:</span> <span class="s1">&#39;history&#39;</span><span class="p">,</span>
  <span class="n">base</span><span class="p">:</span> <span class="n">process</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">BASE_URL</span><span class="p">,</span>
  <span class="n">routes</span>
<span class="p">})</span>

<span class="n">export</span> <span class="n">default</span> <span class="n">router</span>
</pre></div>
</div>
<p>编写用于显示该功能的用户界面，在view文件夹中新建HomeIndex.vue文件，该文件就是上述代码引入的组件。</p>
<p>本例定义一个用户信息数组，如果用户传递的ID参数范围是1～4，则显示相应用户的信息，如果超过这个范围，则显示不存在该用户。模板代码中显示基本的用户信息。</p>
<p>完整代码如下：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;template&gt;
  &lt;div&gt;
    &lt;div&gt;用户信息：&lt;/div&gt;
    &lt;div&gt;用户id：{{ this.user.id }}&lt;/div&gt;
    &lt;div&gt;用户名称：{{ this.user.name }}&lt;/div&gt;
    &lt;div&gt;用户性别：{{ this.user.sex }}&lt;/div&gt;
    &lt;div&gt;用户邮箱：{{ this.user.email }}&lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
export default {
  name: &#39;HomeIndex&#39;,
  data () {
    return {
      users: [
        { id: 1, name: &#39;用户1&#39;, sex: &#39;男&#39;, email: &#39;1@qq.com&#39; },
        { id: 2, name: &#39;用户2&#39;, sex: &#39;女&#39;, email: &#39;1@qq.com&#39; },
        { id: 3, name: &#39;用户3&#39;, sex: &#39;女&#39;, email: &#39;1@qq.com&#39; },
        { id: 4, name: &#39;用户4&#39;, sex: &#39;男&#39;, email: &#39;1@qq.com&#39; }
      ],
      user: {}
    }
  },
  // 在创建时获取参数
  created () {
    console.log(this.$route.params.id)
    const id = this.$route.params.id
    if (id &gt; 4) {
      this.user = { id: 0, name: &#39;无此用户&#39;, sex: &#39;&#39;, email: &#39;&#39; }
    } else {
      this.user = this.users[parseInt(id) - 1]
    }
  }
}
&lt;/script&gt;

&lt;style scoped&gt;

&lt;/style&gt;
</pre></div>
</div>
<p>可以看到，传递的参数（id）可以使用this.<span class="math notranslate nohighlight">\(route.params.id来获取。也就是说，如果只是为了在页面中显示该参数，使用{{\)</span>route.params.id
}}就可以完成，</p>
<p>当访问http://localhost: 8081/user/4时，自动进入该路由</p>
<img alt="../_images/image-20220224180214746.png" src="../_images/image-20220224180214746.png" />
<p>对于路由的匹配来说，参数的匹配只是其中很小的一部分。vue-router使用path-to-regexp作为路径匹配引擎，可以支持更多的匹配格式，例如正则表达式和多个动态路径参数等。</p>
</section>
<section id="id2">
<h2><a class="toc-backref" href="#id10"><span class="section-number">9.5. </span>5. 路由嵌套</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>Vue.js的基础就是组件，既然基础路由可以存在于App组件中，自然也可以嵌套在任何子组件中。每一个组件都可以拥有自身的路由配置。</p>
<p>也就是说，这样的设计思路可以为拥有同一个路由前缀的组件设计通用模板，<strong>以减轻页面组合的工作量，从而更好地实现组件的复用，尤其是可以实现小范围的页面刷新</strong>。</p>
<p>【示例】在示例的基础上为路由增加两个子路由。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;template&gt;
  &lt;div&gt;
    &lt;div&gt;用户信息：&lt;/div&gt;
    &lt;div&gt;用户id：{{ this.user.id }}&lt;/div&gt;
    &lt;div&gt;用户名称：{{ this.user.name }}&lt;/div&gt;
    &lt;div&gt;用户性别：{{ this.user.sex }}&lt;/div&gt;
    &lt;div&gt;用户邮箱：{{ this.user.email }}&lt;/div&gt;
    &lt;router-view&gt;&lt;/router-view&gt;
  &lt;/div&gt;
&lt;/template&gt;
</pre></div>
</div>
<p>因为<code class="docutils literal notranslate"><span class="pre">&lt;router-view&gt;&lt;/router-view&gt;</span></code>已经是全局注册，所以可以在任何组件中使用，这并不影响正常的页面访问。</p>
<p>（2）修改路由文件。修改router文件夹下的index.js文件，在User路由中添加两条子路由，编写在children参数中，同时引入需要的组件，具体代码如下：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">HomeIndex</span> <span class="kn">from</span> <span class="s1">&#39;@/views/HomeIndex&#39;</span>
<span class="kn">import</span> <span class="nn">UM</span> <span class="kn">from</span> <span class="s1">&#39;@/views/UserMessage&#39;</span>
<span class="kn">import</span> <span class="nn">UD</span> <span class="kn">from</span> <span class="s1">&#39;@/views/UserDetail&#39;</span>

<span class="n">Vue</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">VueRouter</span><span class="p">)</span>

<span class="n">const</span> <span class="n">routes</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="n">path</span><span class="p">:</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;home&#39;</span><span class="p">,</span>
    <span class="n">component</span><span class="p">:</span> <span class="n">HomeView</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="n">path</span><span class="p">:</span> <span class="s1">&#39;/user/:id&#39;</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;HomeIndex&#39;</span><span class="p">,</span>
    <span class="n">component</span><span class="p">:</span> <span class="n">HomeIndex</span><span class="p">,</span>
    <span class="n">children</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span> <span class="n">path</span><span class="p">:</span> <span class="s1">&#39;um&#39;</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">UM</span> <span class="p">},</span>
      <span class="p">{</span> <span class="n">path</span><span class="p">:</span> <span class="s1">&#39;ud&#39;</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">UD</span> <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>（3）在views文件夹中定义两个子路由的组件，分别命名为UserDetail.vue和UserMessage.vue，在其中显示一些内容。</p>
<p>UserDetail.vue</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">template</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">div</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;detail&quot;</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">detail</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">template</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">script</span><span class="o">&gt;</span>
<span class="n">export</span> <span class="n">default</span> <span class="p">{</span>
  <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;UserDetail&#39;</span><span class="p">,</span>
  <span class="n">data</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="o">//</span>  <span class="n">设定用户消息</span>
      <span class="n">detail</span><span class="p">:</span> <span class="s1">&#39;用户的详细信息&#39;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="o">//</span>  <span class="n">在创建时进行参数获取</span>
  <span class="n">created</span> <span class="p">()</span> <span class="p">{</span>
    <span class="o">//</span>  <span class="n">打印访问参数</span>
    <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;detail组件创建&#39;</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="o">&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">style</span><span class="o">&gt;</span>
<span class="c1">#detail {</span>
  <span class="n">color</span><span class="p">:</span> <span class="n">red</span><span class="p">;</span>
<span class="p">}</span>
<span class="o">&lt;/</span><span class="n">style</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>UserMessage.vue</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;template&gt;
  &lt;div&gt;
    &lt;div id=&quot;message&quot;&gt;用户消息：{{ message }}&lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
export default {
  name: &#39;UserMessage&#39;,
  data () {
    return {
      //  设定用户消息
      message: &#39;暂时没有消息&#39;
    }
  },
  //  在创建时进行参数获取
  created () {
    // 打印访问参数
    console.log(&#39;message组件创建&#39;)
  }
}
&lt;/script&gt;

&lt;style&gt;
#message {
  color: red;
}
&lt;/style&gt;
</pre></div>
</div>
<p>访问http://localhost:8081/user/3/ud，在User信息的下方出现“用户的详细信息”</p>
<p>访问http://localhost:8081/user/3/um，在User信息的下方出现“用户消息：暂时没有消息”</p>
</section>
<section id="id3">
<h2><a class="toc-backref" href="#id11"><span class="section-number">9.6. </span>6. 路由跳转</a><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>对于模板页面，vue-router提供了<code class="docutils literal notranslate"><span class="pre">&lt;router-link</span> <span class="pre">to=&quot;&quot;&gt;</span> <span class="pre">&lt;/router-link&gt;</span></code>组件，该组件可以在任何组件中使用，类似于HTML中的<code class="docutils literal notranslate"><span class="pre">&lt;a&gt;</span></code>标签实现对导航页面的定义。</p>
<p>该组件通过to参数指定跳转页面。如果在新建实例时选择自动引入vue-router，则生成的页面中包含该组件的实例，位于App.vue中，用于主页和About页面的跳转，其代码如下：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;template&gt;
  &lt;div id=&quot;app&quot;&gt;
    &lt;nav&gt;
      &lt;router-link to=&quot;/&quot;&gt;Home&lt;/router-link&gt; |
      &lt;router-link to=&quot;/about&quot;&gt;About&lt;/router-link&gt;
    &lt;/nav&gt;
&lt;!--    引入路由显示组件--&gt;
     &lt;router-view&gt;&lt;/router-view&gt;
  &lt;/div&gt;
&lt;/template&gt;
</pre></div>
</div>
<p>单击链接可以跳转页面。查看源代码可以发现，页面本身被解析成了一个标准的<code class="docutils literal notranslate"><span class="pre">&lt;a&gt;</span></code>标签。</p>
<p>通过代码也可以实现路由路径的指定和跳转，这就不得不提router实例了，也就是组件中的<code class="docutils literal notranslate"><span class="pre">this.$router</span></code>。</p>
<p>在Vue.js中以下两类代码是等同的。</p>
<p>在模板中使用：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">router</span><span class="o">-</span><span class="n">link</span> <span class="n">to</span><span class="o">=</span><span class="s2">&quot;/&quot;</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>在代码中使用：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>this.$router.push(&#39;/&#39;)
</pre></div>
</div>
<p>push()方法的参数可以是字符串路径或描述地址的对象。一般的字符串路径如下：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;user&#39;</span><span class="p">,</span><span class="n">params</span><span class="p">:</span> <span class="p">{</span><span class="n">userId</span><span class="p">:</span> <span class="s1">&#39;123&#39;</span><span class="p">}</span> <span class="p">}</span>
</pre></div>
</div>
<p>根据用户输入的id参数进行跳转。更改后的HomeIndex代码如下：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;template&gt;
  &lt;div&gt;
    &lt;div&gt;用户信息：&lt;/div&gt;
    &lt;div&gt;用户id：{{ this.user.id }}&lt;/div&gt;
    &lt;div&gt;用户名称：{{ this.user.name }}&lt;/div&gt;
    &lt;div&gt;用户性别：{{ this.user.sex }}&lt;/div&gt;
    &lt;div&gt;用户邮箱：{{ this.user.email }}&lt;/div&gt;
    &lt;router-view&gt;&lt;/router-view&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
export default {
  name: &#39;HomeIndex&#39;,
  data () {
    return {
      users: [
        { id: 1, name: &#39;用户1&#39;, sex: &#39;男&#39;, email: &#39;1@qq.com&#39; },
        { id: 2, name: &#39;用户2&#39;, sex: &#39;女&#39;, email: &#39;1@qq.com&#39; },
        { id: 3, name: &#39;用户3&#39;, sex: &#39;女&#39;, email: &#39;1@qq.com&#39; },
        { id: 4, name: &#39;用户4&#39;, sex: &#39;男&#39;, email: &#39;1@qq.com&#39; }
      ],
      user: {}
    }
  },
  // 在创建时获取参数
  created () {
    // 打印访问参数
    console.log(this.$route.params.id)
    const id = this.$route.params.id
    if (id &gt; 4) {
      this.user = { id: 0, name: &#39;无此用户&#39;, sex: &#39;&#39;, email: &#39;&#39; }
    } else {
      // eslint-disable-next-line eqeqeq
      if (id == 1) {
        this.$router.push(&#39;/user/1/um&#39;)
        // eslint-disable-next-line eqeqeq
      } else if (id == 2) {
        this.$router.replace(&#39;/user/2/ud&#39;)
      }
      // 确定用户
      this.user = this.users[parseInt(id) - 1]
    }
  },
  updated () {
    console.log(&#39;该页面update&#39;)
  }
}
&lt;/script&gt;

&lt;style scoped&gt;

&lt;/style&gt;
</pre></div>
</div>
<p>在浏览器中打开一个新的页面进行测试，输入地址http://localhost:8081/user/1，该页面会自动跳转至http://localhost:8081/user/1/um，并且可以执行回退操作。</p>
<p>单击“回退”按钮，该路径可以回退至http://localhost:8081/user/1，并且在User.vue页面出现update提示。</p>
<p>如果输入地址http://localhost:8081/user/2，则会调用replace直接替换页面，当前页面自动关闭，不能回退。</p>
<p>除了这两个方法以外，router还提供了go(n)方法来操作history栈，表示在历史中前进或后退多少步，类似于window.history.go(n)。如果参数为负整数，则代表历史记录的后退；</p>
<p>如果为正整数，则表示历史记录的前进；如果数字超过了页面堆，则失败。</p>
</section>
<section id="id4">
<h2><a class="toc-backref" href="#id12"><span class="section-number">9.7. </span>7. 导航守卫</a><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>vue-router提供了针对路由的导航守卫，可以在路由变化时执行一些代码，类似于某些开发框架中的中间件概念，可以针对全局路由或某一个特定路由。</p>
<p>【示例】</p>
<p>本例增加的日志打印导航守卫是一个全局前置导航守卫，它会在用户访问任何一个路径时打印用户访问路径的日志，这类数据可以通过后端接口记录在服务器中，用于用户的行为分析。</p>
<p>代码编写在router:raw-latex:<cite>index</cite>.js文件中，在原来的路由代码下增加如下代码：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="p">{</span> <span class="n">createRouter</span><span class="p">,</span> <span class="n">createWebHistory</span> <span class="p">}</span> <span class="kn">from</span> <span class="s1">&#39;vue-router&#39;</span>
<span class="kn">import</span> <span class="nn">HomeView</span> <span class="kn">from</span> <span class="s1">&#39;../views/HomeView.vue&#39;</span>
<span class="kn">import</span> <span class="nn">HomeIndex</span> <span class="kn">from</span> <span class="s1">&#39;@/views/HomeIndex&#39;</span>
<span class="kn">import</span> <span class="nn">UM</span> <span class="kn">from</span> <span class="s1">&#39;@/views/UserMessage&#39;</span>
<span class="kn">import</span> <span class="nn">UD</span> <span class="kn">from</span> <span class="s1">&#39;@/views/UserDetail&#39;</span>

<span class="n">const</span> <span class="n">routes</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="n">path</span><span class="p">:</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;home&#39;</span><span class="p">,</span>
    <span class="n">component</span><span class="p">:</span> <span class="n">HomeView</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="n">path</span><span class="p">:</span> <span class="s1">&#39;/about&#39;</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;about&#39;</span><span class="p">,</span>
    <span class="o">//</span> <span class="n">route</span> <span class="n">level</span> <span class="n">code</span><span class="o">-</span><span class="n">splitting</span>
    <span class="o">//</span> <span class="n">this</span> <span class="n">generates</span> <span class="n">a</span> <span class="n">separate</span> <span class="n">chunk</span> <span class="p">(</span><span class="n">about</span><span class="o">.</span><span class="p">[</span><span class="nb">hash</span><span class="p">]</span><span class="o">.</span><span class="n">js</span><span class="p">)</span> <span class="k">for</span> <span class="n">this</span> <span class="n">route</span>
    <span class="o">//</span> <span class="n">which</span> <span class="ow">is</span> <span class="n">lazy</span><span class="o">-</span><span class="n">loaded</span> <span class="n">when</span> <span class="n">the</span> <span class="n">route</span> <span class="ow">is</span> <span class="n">visited</span><span class="o">.</span>
    <span class="n">component</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="n">import</span><span class="p">(</span><span class="o">/*</span> <span class="n">webpackChunkName</span><span class="p">:</span> <span class="s2">&quot;about&quot;</span> <span class="o">*/</span> <span class="s1">&#39;../views/AboutView.vue&#39;</span><span class="p">)</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="n">path</span><span class="p">:</span> <span class="s1">&#39;/user/:id&#39;</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;HomeIndex&#39;</span><span class="p">,</span>
    <span class="n">component</span><span class="p">:</span> <span class="n">HomeIndex</span><span class="p">,</span>
    <span class="n">children</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span> <span class="n">path</span><span class="p">:</span> <span class="s1">&#39;um&#39;</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">UM</span> <span class="p">},</span>
      <span class="p">{</span> <span class="n">path</span><span class="p">:</span> <span class="s1">&#39;ud&#39;</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">UD</span> <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">]</span>

<span class="n">const</span> <span class="n">router</span> <span class="o">=</span> <span class="n">createRouter</span><span class="p">({</span>
  <span class="n">history</span><span class="p">:</span> <span class="n">createWebHistory</span><span class="p">(</span><span class="n">process</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">BASE_URL</span><span class="p">),</span>
  <span class="n">routes</span>
<span class="p">})</span>

<span class="o">//</span> <span class="n">前置导航守卫</span>
<span class="n">router</span><span class="o">.</span><span class="n">beforeEach</span><span class="p">((</span><span class="n">to</span><span class="p">,</span> <span class="n">from</span><span class="p">,</span> <span class="nb">next</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="o">//</span> <span class="n">打印用户的相关资料</span>
  <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;用户即将进入路由&#39;</span> <span class="o">+</span> <span class="n">to</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
  <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;当前用户来源&#39;</span> <span class="o">+</span> <span class="n">from</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
  <span class="nb">next</span><span class="p">()</span>
<span class="p">})</span>
<span class="n">export</span> <span class="n">default</span> <span class="n">router</span>
</pre></div>
</div>
<p>以上代码通过router.beforeEach()创建一个全局导航守卫，并在所有的路由被访问时调用该守卫。</p>
<img alt="../_images/image-20220301142229309.png" src="../_images/image-20220301142229309.png" />
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="08.Vue.js%E7%9A%84%E7%BB%84%E4%BB%B6%E5%8C%96.html" class="btn btn-neutral float-left" title="8. Vue.js的组件化" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="10.Vue.js%E7%9A%84%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E5%BA%93Vuex%E5%92%8CPinia.html" class="btn btn-neutral float-right" title="10. Vue.js的状态管理库Vuex和Pinia" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, huxiaojian.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>