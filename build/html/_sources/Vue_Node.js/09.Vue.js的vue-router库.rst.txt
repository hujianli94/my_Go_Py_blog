.. role:: raw-latex(raw)
   :format: latex
..

.. contents::
   :depth: 3
..

Vue.jsçš„vue-routeråº“
====================

1.Vue.jsçš„é¡µé¢è·¯ç”±å®ç°
----------------------

Vue.jsæ˜¯å¯¹å‰ç«¯æŠ€æœ¯çš„é©æ–°ï¼Œæ˜¯ä¸ºäº†æå‡ä¼ ç»ŸHTMLä¸­DOMèŠ‚ç‚¹çš„æ€§èƒ½è€Œå‡ºç°çš„æŠ€æœ¯ï¼Œå®ƒå’ŒReact.jsæ¡†æ¶ä¸€æ ·ï¼Œéƒ½æ˜¯ä¸ºäº†è®©å•é¡µé¢åº”ç”¨èƒ½å¤Ÿæé€Ÿåœ°è½½å…¥å’Œå“åº”ã€‚

ç°ä»£çš„æµè§ˆå™¨ä¸ºå¼€å‘è€…æä¾›äº†ä¸€ä¸ªå¯ä»¥ä½¿ç”¨çš„â€œæ“ä½œç³»ç»Ÿâ€ï¼Œå„ç±»ç½‘é¡µæœ¬èº«å°±æ˜¯æµè§ˆå™¨ä¸­çš„åº”ç”¨ã€‚è¿™ç±»åº”ç”¨å®ç°äº†æ‰“å¼€å³ç”¨ï¼Œèƒ½è¾¾åˆ°å’Œæœ¬åœ°åº”ç”¨ä¸€æ ·çš„æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒã€‚

è¿™ç§ä½“éªŒå½’åŠŸäºå‰ç«¯æŠ€æœ¯çš„ä¸æ–­æ”¹è¿›ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒVue.jså’ŒReact.jsç­‰æ¡†æ¶æ‰“é€ äº†æ–°æ—¶ä»£çš„ç½‘é¡µâ€œåº”ç”¨ï¼ˆAppï¼‰â€ã€‚

Vue.jsä½¿ç”¨è™šæ‹ŸDOMå¤„ç†å•é¡µé¢ï¼Œç„¶åä½¿ç”¨Webpackæ‰“åŒ…ã€‚

é€šè¿‡ä¹‹å‰çš„ç¤ºä¾‹ï¼Œè¯»è€…ä¹Ÿè®¸å·²ç»å‘ç°ï¼Œæ— è®ºè¯­æ³•å’Œå†™æ³•å¦‚ä½•ä¸åŒï¼ŒVue.jsç¨‹åºæ‰“åŒ…åéƒ½æ˜¯ä¸€ä¸ªå•ä¸€çš„HTMLæ–‡ä»¶ï¼ŒåŒæ—¶ä¼šå¼•å…¥ä¸€ä¸ªæ ‡å‡†çš„JavaScriptæ–‡ä»¶ã€‚

ä¹Ÿå°±æ˜¯è¯´ï¼ŒVue.jsä¸­ç¼–å†™çš„æ‰€æœ‰ä»£ç éƒ½è¢«Webpackè‡ªåŠ¨æ‰“åŒ…æˆå¯ä»¥è¢«æµè§ˆå™¨è§£æçš„HTMLå’ŒJavaScriptä»£ç ï¼Œå¹¶ä¸”é¡¹ç›®æœ¬èº«å°±åªæœ‰ä¸€ä¸ªé¡µé¢ã€‚

è¿™æ„å‘³ç€æ‰€æœ‰çš„ç”¨æˆ·å¯¹æœåŠ¡å™¨å‘å‡ºè¿›å…¥é¡µé¢çš„è¯·æ±‚æ—¶ï¼Œåªä¼šå¯¹æœåŠ¡å™¨å‘å‡ºä¸€æ¬¡è¯·æ±‚ã€‚

   æ³¨æ„ï¼šä¸€ä¸ªåº”ç”¨åªæœ‰ä¸€ä¸ªé¡µé¢æ˜¯ä¸åˆ‡å®é™…çš„ï¼Œå°†æ‰€æœ‰åŠŸèƒ½å †ç§¯åœ¨ä¸€ä¸ªé¡µé¢ä¸­ï¼Œä¸ä»…å½±å“ç”¨æˆ·ä½“éªŒï¼Œè¿˜å½±å“å¼€å‘çš„æ•ˆç‡ï¼ˆå¤§é‡ä»£ç å åŠ åœ¨ä¸€èµ·ï¼‰ã€‚

ä¼ ç»Ÿçš„HTMLç½‘é¡µåº”ç”¨å¦‚æœè¿›è¡Œé¡µé¢è·³è½¬ï¼Œä¼šæ ¹æ®ç½‘é¡µåœ°å€ï¼ˆURLï¼‰æ¥åˆ·æ–°é¡µé¢ï¼Œåœ¨ç½‘é€Ÿæå¤§æé«˜çš„ä»Šå¤©ï¼Œè¿™ç±»è·³è½¬ä»ä¼šä¸å¯é¿å…åœ°å‡ºç°â€œç™½å±â€ç°è±¡ï¼Œ

è¿™æ˜¾ç„¶ä¸æ˜¯Vue.jså•é¡µé¢åº”ç”¨æƒ³è¦çš„æ•ˆæœã€‚è€Œåº”ç”¨æœ¬èº«åˆéœ€è¦URLæ¥æ§åˆ¶é¡µé¢ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒVue.jsæä¾›äº†vue-routeræ¥å®ç°é¡µé¢è·³è½¬ã€‚

vue-routeræä¾›äº†ä¸¤ç§æ¨¡å¼æ¨¡æ‹ŸURLï¼šhashæ¨¡å¼å’Œhistoryæ¨¡å¼ã€‚

ï¼ˆ1ï¼‰hashæ¨¡å¼æ˜¯é»˜è®¤æ¨¡å¼ï¼Œä½¿ç”¨ç½‘é¡µçš„URLæ¨¡æ‹Ÿä¸€ä¸ªå®Œæ•´çš„URLï¼Œå½“URLæ”¹å˜æ—¶ï¼Œé‡æ–°è·å–hashå¯¹åº”çš„é¡µé¢ï¼ˆåœ¨Vue.jsä¸­æ˜¯éœ€è¦æ˜¾ç¤ºçš„ç»„ä»¶ï¼‰ï¼Œå¹¶å°†è¿™äº›å†…å®¹æ˜¾ç¤ºåœ¨é¡µé¢ä¸­ï¼Œè¿™æ ·æ¨¡æ‹Ÿçš„URLä¸ä¼šè®©æ•´ä¸ªé¡µé¢é‡æ–°åŠ è½½ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé¡µé¢åªåœ¨é¦–æ¬¡åŠ è½½æ—¶åˆ·æ–°ã€‚è¿™æ ·å°±åœ¨æ— åˆ·æ–°çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡æ§åˆ¶ç»„ä»¶çš„æ˜¾ç¤ºï¼Œå®Œæˆé¡µé¢çš„åˆ‡æ¢ã€‚

vue-routerå¦‚æœé‡‡ç”¨é»˜è®¤çš„hashæ¨¡å¼ï¼Œä¼šè‡ªåŠ¨äº§ç”Ÿâ€œ#â€ã€‚

ï¼ˆ2ï¼‰historyæ¨¡å¼é’ˆå¯¹çš„æ˜¯æ”¯æŒHTML
5æ–°ç‰¹æ€§historyçš„æµè§ˆå™¨ï¼Œå…¶æœ¬èº«å°±æ˜¯ç”¨æˆ·è®¿é—®é¡µé¢æ—¶æµè§ˆè®°å½•çš„å †æ ˆï¼ŒHTML
5å…è®¸æ“ä½œhistoryæ ˆä¸­çš„å†…å®¹ã€‚

   æ³¨æ„ï¼šæ— è®ºé‡‡ç”¨ä½•ç§æ–¹å¼é…ç½®vue-routerï¼ŒVue.jså•é¡µé¢åº”ç”¨éƒ½ä¸ä¼šåˆ·æ–°é¡µé¢ã€‚

2. ä½¿ç”¨vue-cliåˆå§‹åŒ–Vue.jsé¡¹ç›®
------------------------------

æ‰€æœ‰çš„Vue.jsé¡¹ç›®éƒ½é‡‡ç”¨vue-cliï¼ˆå®˜æ–¹æä¾›çš„å‘½ä»¤è¡Œç®¡ç†å·¥å…·ï¼‰æ„å»ºï¼Œè¿™æ¯”å‰é¢ä»‹ç»çš„æ‰‹åŠ¨é…ç½®Webpackç­‰æ–¹å¼è¦ç®€å•å¾—å¤šã€‚

ã€ç¤ºä¾‹ã€‘ä½¿ç”¨vue-clié…ç½®Vue.jsé¡¹ç›®ã€‚

::

   # å®‰è£…æ·˜å®npm
   npm install -g cnpm --registry=https://registry.npm.taobao.org

   # vue-cli å®‰è£…ä¾èµ–åŒ…
   cnpm install -g @vue/cli

..

   æ³¨æ„ï¼šä¹‹å‰æ²¡æœ‰é€‰æ‹©vue-cliæ„å»ºé¡¹ç›®çš„ä¸€ä¸ªåŸå› æ˜¯ï¼ŒWebpackæ˜¯å¤§å¤šæ•°æ¡†æ¶æ„å»ºçš„é€šç”¨å·¥å…·ï¼Œäº†è§£Webpackçš„é…ç½®éå¸¸é‡è¦ã€‚

ï¼ˆ2ï¼‰åœ¨å‘½ä»¤è¡Œå·¥å…·ä¸­ä½¿ç”¨vueç›¸å…³å‘½ä»¤ã€‚é¦–å…ˆä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æ–°å»ºä¸€ä¸ªé¡¹ç›®ï¼Œåç§°ä¸ºrouter-testã€‚

å¯å‚è€ƒæ–‡çŒ®ï¼š

http://vue.ezops.cn/#/src/01/%E8%84%9A%E6%89%8B%E6%9E%B6

::

   vue create router-test
   Vue CLI v5.0.1
   ? Please pick a preset:
     Default ([Vue 3] babel, eslint)
     Default ([Vue 2] babel, eslint)
   > Manually select features          # é€‰æ‹©æ‰‹åŠ¨

(3) è¦ç”¨åˆ°vue-routeråº“ï¼Œä½†é¡¹ç›®å¹¶æ²¡æœ‰é»˜è®¤å®‰è£…ï¼Œæ‰€ä»¥åº”å½“é€‰æ‹©é…ç½®Manually
    select featuresï¼Œå‹¾é€‰è¯¥æ¨¡å—ï¼ˆé€šè¿‡ç©ºæ ¼é”®å‹¾é€‰ï¼‰å¹¶ä¸”æŒ‰Enteré”®ç¡®è®¤

::

   <enter> to proceed)
    (*) Babel
    ( ) TypeScript
    ( ) Progressive Web App (PWA) Support
   >(*) Router                 # å‹¾é€‰
    ( ) Vuex
    ( ) CSS Pre-processors
    (*) Linter / Formatter         # å‹¾é€‰
    ( ) Unit Testing
    ( ) E2E Testing

ï¼ˆ4ï¼‰ç¡®è®¤ä¹‹åï¼Œä¼šè¯¢é—®æ˜¯å¦ä½¿ç”¨historyæ¨¡å¼ï¼Œè¿™é‡Œé€‰æ‹©æ˜¯ï¼ˆYï¼‰ã€‚æ¥ä¸‹æ¥é…ç½®EsLintç­‰é€‰é¡¹ï¼Œå¯ä»¥é€‰æ‹©é»˜è®¤é€‰é¡¹ã€‚

::

   ? Choose a version of Vue.js that you want to start the project with
     3.x
   > 2.x

   ? Use history mode for router? (Requires proper server setup for index fallback in production) Yes      # Y
   ? Pick a linter / formatter config: Standard
   ? Pick additional lint features: Lint on save
   ? Where do you prefer placing config for Babel, ESLint, etc.? In dedicated config files
   ? Save this as a preset for future projects? No

ï¼ˆ5ï¼‰å®‰è£…å®Œæˆåï¼Œå¯ä»¥çœ‹åˆ°ï¼ŒæˆåŠŸåˆ›å»ºäº†é¡¹ç›®ã€‚

::

   success Saved lockfile.
   Done in 27.95s.
   âš“  Running completion hooks...

   ğŸ“„  Generating README.md...

   ğŸ‰  Successfully created project router-test.
   ğŸ‘‰  Get started with the following commands:

    $ cd router-test
    $ yarn serve

ä½¿ç”¨vue-cliåˆ›å»ºäº†ä¸€ä¸ªåŒ…å«vue-routerçš„é¡¹ç›®ï¼Œå…¶ä¸­é…ç½®äº†ç›¸åº”çš„å¯åŠ¨å’Œæ„å»ºæ‰“åŒ…æŒ‡ä»¤ã€‚é¡¹ç›®çš„package.jsonä»£ç å¦‚ä¸‹ï¼š

::

   {
     "name": "router-test",
     "version": "0.1.0",
     "private": true,
     "scripts": {
       "serve": "vue-cli-service serve",
       "build": "vue-cli-service build",
       "lint": "vue-cli-service lint"
     },
     "dependencies": {
       "core-js": "^3.8.3",
       "vue": "^2.6.14",
       "vue-router": "^3.5.1"
     },
     "devDependencies": {
       "@babel/core": "^7.12.16",
       "@babel/eslint-parser": "^7.12.16",
       "@vue/cli-plugin-babel": "~5.0.0",
       "@vue/cli-plugin-eslint": "~5.0.0",
       "@vue/cli-plugin-router": "~5.0.0",
       "@vue/cli-service": "~5.0.0",
       "@vue/eslint-config-standard": "^6.1.0",
       "eslint": "^7.32.0",
       "eslint-plugin-import": "^2.25.3",
       "eslint-plugin-node": "^11.1.0",
       "eslint-plugin-promise": "^5.1.0",
       "eslint-plugin-vue": "^8.0.3",
       "vue-template-compiler": "^2.6.14"
     }
   }

æœ€æ–°ç‰ˆæœ¬çš„vue-cliæä¾›äº†å›¾å½¢åŒ–çš„é¡¹ç›®åˆ›å»ºé¡µé¢ï¼Œéœ€è¦é€šè¿‡æµè§ˆå™¨é…ç½®é¡¹ç›®ã€‚åœ¨å‘½ä»¤è¡Œå·¥å…·ä¸­ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å¯åŠ¨vue-cliï¼š

::

   vue ui

ä¸Šé¢çš„å‘½ä»¤ä¼šå¯åŠ¨ä¸€ä¸ªå°æœåŠ¡å™¨ï¼ŒåŒæ—¶æ‰“å¼€ä¸€ä¸ªé¡¹ç›®é…ç½®é¡µé¢ï¼Œå¦‚å›¾æ‰€ç¤ºï¼Œå¯ä»¥åœ¨å…¶ä¸­æ›´æ”¹å·²åˆ›å»ºçš„é¡¹ç›®æˆ–åˆ›å»ºæ–°çš„é¡¹ç›®ã€‚

   æ³¨æ„ï¼šä½¿ç”¨vue-cliæ„å»ºçš„é¡¹ç›®æ²¡æœ‰Webpackçš„ç›¸å…³é…ç½®ï¼Œè¿™å¹¶ä¸æ„å‘³ç€é¡¹ç›®æ²¡æœ‰ä½¿ç”¨Webpackï¼Œå› ä¸ºvue-cliæœ¬èº«å°±æ˜¯ä¸€ä¸ªåŸºäºWebpackæ„å»ºçš„Vue.jsä¸“å±æ„å»ºå·¥å…·ã€‚

3. å®‰è£…å’Œé…ç½®vue-router
-----------------------

å¦‚æœéœ€è¦åœ¨ç°æœ‰çš„Vue.jsé¡¹ç›®ä¸­ä½¿ç”¨vue-routerï¼Œæˆ–è€…åœ¨æ„å»ºé¡¹ç›®æ—¶æ²¡æœ‰æ·»åŠ vue-routerï¼Œåˆ™éœ€è¦åƒåœ¨Expressæ¡†æ¶ä¸­ä½¿ç”¨å…¶ä»–æ¨¡å—ä¸€æ ·ï¼Œé€šè¿‡npmå‘½ä»¤å®‰è£…vue-routerã€‚

ï¼ˆ1ï¼‰å®‰è£…å‘½ä»¤å¦‚ä¸‹ï¼š

::

   npm install vue-router

ï¼ˆ2ï¼‰å®‰è£…å®Œæˆåï¼Œå¯ä»¥ç›´æ¥åœ¨main.jsä¸­å®šä¹‰è·¯ç”±å¹¶å¼•ç”¨ï¼Œæˆ–ç¼–å†™ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ç”¨æ¥å®šä¹‰è·¯ç”±ã€‚ç¬”è€…é‡‡ç”¨å•ç‹¬æ–‡ä»¶çš„æ–¹å¼ï¼Œåœ¨srcæ–‡ä»¶å¤¹ä¸­æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹å¹¶å‘½åä¸ºrouterï¼Œç„¶åå®šä¹‰ä¸€ä¸ªJavaScriptæ–‡ä»¶ï¼Œå‘½åä¸ºindex.jsï¼ˆåç§°è‡ªå®šä¹‰å³å¯ï¼‰ã€‚ä»£ç å¦‚ä¸‹ï¼š

::

   import Vue from 'vue'
   import VueRouter from 'vue-router'
   import HomeView from '../views/HomeView.vue'

   Vue.use(VueRouter)

   const routes = [
     {
       path: '/',
       name: 'home',
       component: HomeView
     },
     {
       path: '/about',
       name: 'about',
       // route level code-splitting
       // this generates a separate chunk (about.[hash].js) for this route
       // which is lazy-loaded when the route is visited.
       component: () => import(/* webpackChunkName: "about" */ '../views/AboutView.vue')
     }
   ]

   const router = new VueRouter({
     mode: 'history',
     base: process.env.BASE_URL,
     routes
   })

   export default router

è¯¥æ–‡ä»¶ä¸ä»…å®ä¾‹åŒ–äº†ä¸€ä¸ªVueRouterï¼Œè¿˜å®šä¹‰äº†ä¸€ä¸ªåä¸º\ ``/``\ å’Œ\ ``/about``\ çš„è·¯ç”±ï¼Œè®¿é—®è¯¥è·¯ç”±æ—¶ä¼šè°ƒç”¨ç»„ä»¶HomeViewå’ŒAboutViewã€‚

ï¼ˆ3ï¼‰ç¼–å†™å®Œrouteræ–‡ä»¶åå†ç¼–å†™main.jsï¼Œå…¶ä¸­è¦å¼•å…¥routeræ–‡ä»¶ï¼Œç„¶ååœ¨å®ä¾‹åŒ–Vue.jså¯¹è±¡æ—¶ä¼ å…¥ã€‚ä»£ç å¦‚ä¸‹ï¼š

::

   import Vue from 'vue'
   import App from './App.vue'
   import router from './router'

   Vue.config.productionTip = false

   new Vue({
     router,
     render: h => h(App)
   }).$mount('#app')

ï¼ˆ4ï¼‰æ¥ç€åœ¨App.vueä¸­å¼•å…¥è·¯ç”±ç»„ä»¶ã€‚æœ¬ç« å‰é¢ä»‹ç»è¿‡Vue.jsçš„è·¯ç”±å¹¶ä¸æ˜¯çœŸå®çš„é¡µé¢åˆ·æ–°ï¼Œè€Œæ˜¯å¯¹ç»„ä»¶æ˜¾ç¤ºå†…å®¹çš„åˆ‡æ¢ï¼Œå› æ­¤å°†ç»„ä»¶æ·»åŠ åœ¨App.vueçš„ç»Ÿä¸€Vueæ–‡ä»¶å…¥å£ä¸­ã€‚ä»£ç å¦‚ä¸‹ï¼š

::

   <template>
     <div id="app">
       <nav>
         <router-link to="/">Home</router-link> |
         <router-link to="/about">About</router-link>
       </nav>
   <!--    å¼•å…¥è·¯ç”±æ˜¾ç¤ºç»„ä»¶-->
       <router-view/>
     </div>
   </template>

å› ä¸ºvue-routeråº“æ˜¯å…¨å±€æ³¨å†Œï¼Œåœ¨vue-routeråº“æ³¨å†Œçš„åŒæ—¶å…¶è‡ªå¸¦çš„ç»„ä»¶ä¹Ÿéƒ½æ˜¯å…¨å±€æ³¨å†Œï¼Œæ‰€ä»¥ä¸éœ€è¦åœ¨é¡µé¢çš„componentsä¸­æ³¨å†Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚

   æ³¨æ„ï¼šå¦‚æœåœ¨æ„å»ºVue.jsé¡¹ç›®æ—¶å·²ç»æ·»åŠ äº†vue-routeråº“ï¼Œåˆ™ä¸éœ€è¦ä»»ä½•é…ç½®ä¾¿å¯ä»¥ç›´æ¥ä½¿ç”¨å®ƒã€‚

4. åŠ¨æ€è·¯ç”±åŒ¹é…
---------------

æ— è®ºæ˜¯è‡ªè¡Œå®‰è£…vue-routerï¼Œè¿˜æ˜¯é€šè¿‡vue-cliå‘½ä»¤ç›´æ¥æ„å»ºå·¥ç¨‹ï¼Œéƒ½éœ€è¦ä¿è¯å·¥ç¨‹èƒ½å¤Ÿæ”¯æŒè·¯ç”±ã€‚URLçš„ä½œç”¨é™¤äº†æŒ‡å®šé¡µé¢çš„è®¿é—®åœ°å€å¤–ï¼Œè¿˜åŒ…æ‹¬è·¯ç”±å‚æ•°çš„ä¼ é€’ã€‚åœ¨Vue.jsä¸­é€šè¿‡å‚æ•°ä¹Ÿèƒ½å®ç°è·¯ç”±çš„åŠ¨æ€åŒ¹é…ã€‚ä¾‹å¦‚ï¼ŒCMSç³»ç»Ÿï¼ˆå†…å®¹ç®¡ç†ç³»ç»Ÿï¼‰ä¸­æŸä¸€ç¯‡æ–‡ç« çš„è·¯ç”±è®¿é—®è·¯å¾„å½¢å¼å¦‚ä¸‹ï¼š

::

   http://localhost/article?id=xxx
   http://localhost/article/xxx

ç¬¬ä¸€è¡Œè¡¨ç¤ºä»¥ä¼ ç»Ÿçš„å‚æ•°å½¢å¼è¿›è¡Œè®¿é—®ï¼Œé€šè¿‡GETæ–¹å¼å‘é€è¯·æ±‚ï¼Œå¹¶åœ¨URLä¹‹åè·Ÿéšä¸€ä¸ªâ€œ?â€å’Œidå‚æ•°ï¼Œå…¶ä¸­xxxä¸ºè¯¥æ–‡ç« çš„å”¯ä¸€IDï¼Œé€šè¿‡å®ƒå¯ä»¥æŸ¥è¯¢æ–‡ç« æœ¬èº«ï¼Œå¹¶ä¸”ä¸å­˜åœ¨äºŒä¹‰æ€§ã€‚

ç¬¬äºŒè¡Œæ˜¾ç¤ºçš„å…¶å®å°±æ˜¯åŠ¨æ€è·¯ç”±è§„åˆ’å®ç°çš„åŠŸèƒ½ï¼Œå¯¹æ‰€æœ‰ä»¥â€œåŸºç¡€ç½‘å€+â€˜/article/â€™+å‚æ•°â€å½¢å¼çš„è·¯ç”±è·¯å¾„ç»Ÿä¸€è§£æåœ¨æŸä¸€ä¸ªå¤„ç†é€»è¾‘ä¸­ï¼Œè·¯å¾„æœ€åè·Ÿéšçš„ä¿¡æ¯è¢«è®¤ä¸ºæ˜¯å‚æ•°è€Œä¸æ˜¯è·¯å¾„æœ¬èº«ã€‚

ã€ç¤ºä¾‹ã€‘é€šè¿‡ç”¨æˆ·IDè®¿é—®ç”¨æˆ·çš„ä¸»é¡µã€‚

é¦–å…ˆå®šä¹‰è·¯ç”±ï¼Œä¿®æ”¹routeræ–‡ä»¶å¤¹ä¸­çš„index.jsæ–‡ä»¶ï¼Œå¢åŠ ç›¸åº”çš„ç”¨æˆ·ä¿¡æ¯è·¯ç”±ã€‚ä»¥ä¸‹æ˜¯HomeIndexéƒ¨åˆ†è·¯å¾„å®šä¹‰çš„ä»£ç ï¼š

::

   import HomeIndex from '@/views/HomeIndex'

   Vue.use(VueRouter)

   const routes = [
     {
       path: '/',
       name: 'home',
       component: HomeView
     },
     {
   .....
     },
     {
       path: '/user/:id',
       name: 'HomeIndex',
       component: HomeIndex
     }
   ]

   const router = new VueRouter({
     mode: 'history',
     base: process.env.BASE_URL,
     routes
   })

   export default router

ç¼–å†™ç”¨äºæ˜¾ç¤ºè¯¥åŠŸèƒ½çš„ç”¨æˆ·ç•Œé¢ï¼Œåœ¨viewæ–‡ä»¶å¤¹ä¸­æ–°å»ºHomeIndex.vueæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å°±æ˜¯ä¸Šè¿°ä»£ç å¼•å…¥çš„ç»„ä»¶ã€‚

æœ¬ä¾‹å®šä¹‰ä¸€ä¸ªç”¨æˆ·ä¿¡æ¯æ•°ç»„ï¼Œå¦‚æœç”¨æˆ·ä¼ é€’çš„IDå‚æ•°èŒƒå›´æ˜¯1ï½4ï¼Œåˆ™æ˜¾ç¤ºç›¸åº”ç”¨æˆ·çš„ä¿¡æ¯ï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªèŒƒå›´ï¼Œåˆ™æ˜¾ç¤ºä¸å­˜åœ¨è¯¥ç”¨æˆ·ã€‚æ¨¡æ¿ä»£ç ä¸­æ˜¾ç¤ºåŸºæœ¬çš„ç”¨æˆ·ä¿¡æ¯ã€‚

å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š

::

   <template>
     <div>
       <div>ç”¨æˆ·ä¿¡æ¯ï¼š</div>
       <div>ç”¨æˆ·idï¼š{{ this.user.id }}</div>
       <div>ç”¨æˆ·åç§°ï¼š{{ this.user.name }}</div>
       <div>ç”¨æˆ·æ€§åˆ«ï¼š{{ this.user.sex }}</div>
       <div>ç”¨æˆ·é‚®ç®±ï¼š{{ this.user.email }}</div>
     </div>
   </template>

   <script>
   export default {
     name: 'HomeIndex',
     data () {
       return {
         users: [
           { id: 1, name: 'ç”¨æˆ·1', sex: 'ç”·', email: '1@qq.com' },
           { id: 2, name: 'ç”¨æˆ·2', sex: 'å¥³', email: '1@qq.com' },
           { id: 3, name: 'ç”¨æˆ·3', sex: 'å¥³', email: '1@qq.com' },
           { id: 4, name: 'ç”¨æˆ·4', sex: 'ç”·', email: '1@qq.com' }
         ],
         user: {}
       }
     },
     // åœ¨åˆ›å»ºæ—¶è·å–å‚æ•°
     created () {
       console.log(this.$route.params.id)
       const id = this.$route.params.id
       if (id > 4) {
         this.user = { id: 0, name: 'æ— æ­¤ç”¨æˆ·', sex: '', email: '' }
       } else {
         this.user = this.users[parseInt(id) - 1]
       }
     }
   }
   </script>

   <style scoped>

   </style>

å¯ä»¥çœ‹åˆ°ï¼Œä¼ é€’çš„å‚æ•°ï¼ˆidï¼‰å¯ä»¥ä½¿ç”¨this.\ :math:`route.params.idæ¥è·å–ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœåªæ˜¯ä¸ºäº†åœ¨é¡µé¢ä¸­æ˜¾ç¤ºè¯¥å‚æ•°ï¼Œä½¿ç”¨{{`\ route.params.id
}}å°±å¯ä»¥å®Œæˆï¼Œ

å½“è®¿é—®http://localhost: 8081/user/4æ—¶ï¼Œè‡ªåŠ¨è¿›å…¥è¯¥è·¯ç”±

.. image:: ../_static/image-20220224180214746.png

å¯¹äºè·¯ç”±çš„åŒ¹é…æ¥è¯´ï¼Œå‚æ•°çš„åŒ¹é…åªæ˜¯å…¶ä¸­å¾ˆå°çš„ä¸€éƒ¨åˆ†ã€‚vue-routerä½¿ç”¨path-to-regexpä½œä¸ºè·¯å¾„åŒ¹é…å¼•æ“ï¼Œå¯ä»¥æ”¯æŒæ›´å¤šçš„åŒ¹é…æ ¼å¼ï¼Œä¾‹å¦‚æ­£åˆ™è¡¨è¾¾å¼å’Œå¤šä¸ªåŠ¨æ€è·¯å¾„å‚æ•°ç­‰ã€‚

5. è·¯ç”±åµŒå¥—
-----------

Vue.jsçš„åŸºç¡€å°±æ˜¯ç»„ä»¶ï¼Œæ—¢ç„¶åŸºç¡€è·¯ç”±å¯ä»¥å­˜åœ¨äºAppç»„ä»¶ä¸­ï¼Œè‡ªç„¶ä¹Ÿå¯ä»¥åµŒå¥—åœ¨ä»»ä½•å­ç»„ä»¶ä¸­ã€‚æ¯ä¸€ä¸ªç»„ä»¶éƒ½å¯ä»¥æ‹¥æœ‰è‡ªèº«çš„è·¯ç”±é…ç½®ã€‚

ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™æ ·çš„è®¾è®¡æ€è·¯å¯ä»¥ä¸ºæ‹¥æœ‰åŒä¸€ä¸ªè·¯ç”±å‰ç¼€çš„ç»„ä»¶è®¾è®¡é€šç”¨æ¨¡æ¿ï¼Œ\ **ä»¥å‡è½»é¡µé¢ç»„åˆçš„å·¥ä½œé‡ï¼Œä»è€Œæ›´å¥½åœ°å®ç°ç»„ä»¶çš„å¤ç”¨ï¼Œå°¤å…¶æ˜¯å¯ä»¥å®ç°å°èŒƒå›´çš„é¡µé¢åˆ·æ–°**\ ã€‚

ã€ç¤ºä¾‹ã€‘åœ¨ç¤ºä¾‹çš„åŸºç¡€ä¸Šä¸ºè·¯ç”±å¢åŠ ä¸¤ä¸ªå­è·¯ç”±ã€‚

::

   <template>
     <div>
       <div>ç”¨æˆ·ä¿¡æ¯ï¼š</div>
       <div>ç”¨æˆ·idï¼š{{ this.user.id }}</div>
       <div>ç”¨æˆ·åç§°ï¼š{{ this.user.name }}</div>
       <div>ç”¨æˆ·æ€§åˆ«ï¼š{{ this.user.sex }}</div>
       <div>ç”¨æˆ·é‚®ç®±ï¼š{{ this.user.email }}</div>
       <router-view></router-view>
     </div>
   </template>

å› ä¸º\ ``<router-view></router-view>``\ å·²ç»æ˜¯å…¨å±€æ³¨å†Œï¼Œæ‰€ä»¥å¯ä»¥åœ¨ä»»ä½•ç»„ä»¶ä¸­ä½¿ç”¨ï¼Œè¿™å¹¶ä¸å½±å“æ­£å¸¸çš„é¡µé¢è®¿é—®ã€‚

ï¼ˆ2ï¼‰ä¿®æ”¹è·¯ç”±æ–‡ä»¶ã€‚ä¿®æ”¹routeræ–‡ä»¶å¤¹ä¸‹çš„index.jsæ–‡ä»¶ï¼Œåœ¨Userè·¯ç”±ä¸­æ·»åŠ ä¸¤æ¡å­è·¯ç”±ï¼Œç¼–å†™åœ¨childrenå‚æ•°ä¸­ï¼ŒåŒæ—¶å¼•å…¥éœ€è¦çš„ç»„ä»¶ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š

::

   import HomeIndex from '@/views/HomeIndex'
   import UM from '@/views/UserMessage'
   import UD from '@/views/UserDetail'

   Vue.use(VueRouter)

   const routes = [
     {
       path: '/',
       name: 'home',
       component: HomeView
     },
     {
       path: '/user/:id',
       name: 'HomeIndex',
       component: HomeIndex,
       children: [
         { path: 'um', component: UM },
         { path: 'ud', component: UD }
       ]
     }
   ]

ï¼ˆ3ï¼‰åœ¨viewsæ–‡ä»¶å¤¹ä¸­å®šä¹‰ä¸¤ä¸ªå­è·¯ç”±çš„ç»„ä»¶ï¼Œåˆ†åˆ«å‘½åä¸ºUserDetail.vueå’ŒUserMessage.vueï¼Œåœ¨å…¶ä¸­æ˜¾ç¤ºä¸€äº›å†…å®¹ã€‚

UserDetail.vue

::

   <template>
     <div>
       <div id="detail">{{ detail }}</div>
     </div>
   </template>

   <script>
   export default {
     name: 'UserDetail',
     data () {
       return {
         //  è®¾å®šç”¨æˆ·æ¶ˆæ¯
         detail: 'ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯'
       }
     },
     //  åœ¨åˆ›å»ºæ—¶è¿›è¡Œå‚æ•°è·å–
     created () {
       //  æ‰“å°è®¿é—®å‚æ•°
       console.log('detailç»„ä»¶åˆ›å»º')
     }
   }
   </script>
   <style>
   #detail {
     color: red;
   }
   </style>

UserMessage.vue

::

   <template>
     <div>
       <div id="message">ç”¨æˆ·æ¶ˆæ¯ï¼š{{ message }}</div>
     </div>
   </template>

   <script>
   export default {
     name: 'UserMessage',
     data () {
       return {
         //  è®¾å®šç”¨æˆ·æ¶ˆæ¯
         message: 'æš‚æ—¶æ²¡æœ‰æ¶ˆæ¯'
       }
     },
     //  åœ¨åˆ›å»ºæ—¶è¿›è¡Œå‚æ•°è·å–
     created () {
       // æ‰“å°è®¿é—®å‚æ•°
       console.log('messageç»„ä»¶åˆ›å»º')
     }
   }
   </script>

   <style>
   #message {
     color: red;
   }
   </style>

è®¿é—®http://localhost:8081/user/3/udï¼Œåœ¨Userä¿¡æ¯çš„ä¸‹æ–¹å‡ºç°â€œç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯â€

è®¿é—®http://localhost:8081/user/3/umï¼Œåœ¨Userä¿¡æ¯çš„ä¸‹æ–¹å‡ºç°â€œç”¨æˆ·æ¶ˆæ¯ï¼šæš‚æ—¶æ²¡æœ‰æ¶ˆæ¯â€

6. è·¯ç”±è·³è½¬
-----------

å¯¹äºæ¨¡æ¿é¡µé¢ï¼Œvue-routeræä¾›äº†\ ``<router-link to=""> </router-link>``\ ç»„ä»¶ï¼Œè¯¥ç»„ä»¶å¯ä»¥åœ¨ä»»ä½•ç»„ä»¶ä¸­ä½¿ç”¨ï¼Œç±»ä¼¼äºHTMLä¸­çš„\ ``<a>``\ æ ‡ç­¾å®ç°å¯¹å¯¼èˆªé¡µé¢çš„å®šä¹‰ã€‚

è¯¥ç»„ä»¶é€šè¿‡toå‚æ•°æŒ‡å®šè·³è½¬é¡µé¢ã€‚å¦‚æœåœ¨æ–°å»ºå®ä¾‹æ—¶é€‰æ‹©è‡ªåŠ¨å¼•å…¥vue-routerï¼Œåˆ™ç”Ÿæˆçš„é¡µé¢ä¸­åŒ…å«è¯¥ç»„ä»¶çš„å®ä¾‹ï¼Œä½äºApp.vueä¸­ï¼Œç”¨äºä¸»é¡µå’ŒAbouté¡µé¢çš„è·³è½¬ï¼Œå…¶ä»£ç å¦‚ä¸‹ï¼š

::

   <template>
     <div id="app">
       <nav>
         <router-link to="/">Home</router-link> |
         <router-link to="/about">About</router-link>
       </nav>
   <!--    å¼•å…¥è·¯ç”±æ˜¾ç¤ºç»„ä»¶-->
        <router-view></router-view>
     </div>
   </template>

å•å‡»é“¾æ¥å¯ä»¥è·³è½¬é¡µé¢ã€‚æŸ¥çœ‹æºä»£ç å¯ä»¥å‘ç°ï¼Œé¡µé¢æœ¬èº«è¢«è§£ææˆäº†ä¸€ä¸ªæ ‡å‡†çš„\ ``<a>``\ æ ‡ç­¾ã€‚

é€šè¿‡ä»£ç ä¹Ÿå¯ä»¥å®ç°è·¯ç”±è·¯å¾„çš„æŒ‡å®šå’Œè·³è½¬ï¼Œè¿™å°±ä¸å¾—ä¸ærouterå®ä¾‹äº†ï¼Œä¹Ÿå°±æ˜¯ç»„ä»¶ä¸­çš„\ ``this.$router``\ ã€‚

åœ¨Vue.jsä¸­ä»¥ä¸‹ä¸¤ç±»ä»£ç æ˜¯ç­‰åŒçš„ã€‚

åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨ï¼š

::

    <router-link to="/">

åœ¨ä»£ç ä¸­ä½¿ç”¨ï¼š

::

   this.$router.push('/')

push()æ–¹æ³•çš„å‚æ•°å¯ä»¥æ˜¯å­—ç¬¦ä¸²è·¯å¾„æˆ–æè¿°åœ°å€çš„å¯¹è±¡ã€‚ä¸€èˆ¬çš„å­—ç¬¦ä¸²è·¯å¾„å¦‚ä¸‹ï¼š

::

   { name: 'user',params: {userId: '123'} }

æ ¹æ®ç”¨æˆ·è¾“å…¥çš„idå‚æ•°è¿›è¡Œè·³è½¬ã€‚æ›´æ”¹åçš„HomeIndexä»£ç å¦‚ä¸‹ï¼š

::

   <template>
     <div>
       <div>ç”¨æˆ·ä¿¡æ¯ï¼š</div>
       <div>ç”¨æˆ·idï¼š{{ this.user.id }}</div>
       <div>ç”¨æˆ·åç§°ï¼š{{ this.user.name }}</div>
       <div>ç”¨æˆ·æ€§åˆ«ï¼š{{ this.user.sex }}</div>
       <div>ç”¨æˆ·é‚®ç®±ï¼š{{ this.user.email }}</div>
       <router-view></router-view>
     </div>
   </template>

   <script>
   export default {
     name: 'HomeIndex',
     data () {
       return {
         users: [
           { id: 1, name: 'ç”¨æˆ·1', sex: 'ç”·', email: '1@qq.com' },
           { id: 2, name: 'ç”¨æˆ·2', sex: 'å¥³', email: '1@qq.com' },
           { id: 3, name: 'ç”¨æˆ·3', sex: 'å¥³', email: '1@qq.com' },
           { id: 4, name: 'ç”¨æˆ·4', sex: 'ç”·', email: '1@qq.com' }
         ],
         user: {}
       }
     },
     // åœ¨åˆ›å»ºæ—¶è·å–å‚æ•°
     created () {
       // æ‰“å°è®¿é—®å‚æ•°
       console.log(this.$route.params.id)
       const id = this.$route.params.id
       if (id > 4) {
         this.user = { id: 0, name: 'æ— æ­¤ç”¨æˆ·', sex: '', email: '' }
       } else {
         // eslint-disable-next-line eqeqeq
         if (id == 1) {
           this.$router.push('/user/1/um')
           // eslint-disable-next-line eqeqeq
         } else if (id == 2) {
           this.$router.replace('/user/2/ud')
         }
         // ç¡®å®šç”¨æˆ·
         this.user = this.users[parseInt(id) - 1]
       }
     },
     updated () {
       console.log('è¯¥é¡µé¢update')
     }
   }
   </script>

   <style scoped>

   </style>

åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ä¸€ä¸ªæ–°çš„é¡µé¢è¿›è¡Œæµ‹è¯•ï¼Œè¾“å…¥åœ°å€http://localhost:8081/user/1ï¼Œè¯¥é¡µé¢ä¼šè‡ªåŠ¨è·³è½¬è‡³http://localhost:8081/user/1/umï¼Œå¹¶ä¸”å¯ä»¥æ‰§è¡Œå›é€€æ“ä½œã€‚

å•å‡»â€œå›é€€â€æŒ‰é’®ï¼Œè¯¥è·¯å¾„å¯ä»¥å›é€€è‡³http://localhost:8081/user/1ï¼Œå¹¶ä¸”åœ¨User.vueé¡µé¢å‡ºç°updateæç¤ºã€‚

å¦‚æœè¾“å…¥åœ°å€http://localhost:8081/user/2ï¼Œåˆ™ä¼šè°ƒç”¨replaceç›´æ¥æ›¿æ¢é¡µé¢ï¼Œå½“å‰é¡µé¢è‡ªåŠ¨å…³é—­ï¼Œä¸èƒ½å›é€€ã€‚

é™¤äº†è¿™ä¸¤ä¸ªæ–¹æ³•ä»¥å¤–ï¼Œrouterè¿˜æä¾›äº†go(n)æ–¹æ³•æ¥æ“ä½œhistoryæ ˆï¼Œè¡¨ç¤ºåœ¨å†å²ä¸­å‰è¿›æˆ–åé€€å¤šå°‘æ­¥ï¼Œç±»ä¼¼äºwindow.history.go(n)ã€‚å¦‚æœå‚æ•°ä¸ºè´Ÿæ•´æ•°ï¼Œåˆ™ä»£è¡¨å†å²è®°å½•çš„åé€€ï¼›

å¦‚æœä¸ºæ­£æ•´æ•°ï¼Œåˆ™è¡¨ç¤ºå†å²è®°å½•çš„å‰è¿›ï¼›å¦‚æœæ•°å­—è¶…è¿‡äº†é¡µé¢å †ï¼Œåˆ™å¤±è´¥ã€‚

7. å¯¼èˆªå®ˆå«
-----------

vue-routeræä¾›äº†é’ˆå¯¹è·¯ç”±çš„å¯¼èˆªå®ˆå«ï¼Œå¯ä»¥åœ¨è·¯ç”±å˜åŒ–æ—¶æ‰§è¡Œä¸€äº›ä»£ç ï¼Œç±»ä¼¼äºæŸäº›å¼€å‘æ¡†æ¶ä¸­çš„ä¸­é—´ä»¶æ¦‚å¿µï¼Œå¯ä»¥é’ˆå¯¹å…¨å±€è·¯ç”±æˆ–æŸä¸€ä¸ªç‰¹å®šè·¯ç”±ã€‚

ã€ç¤ºä¾‹ã€‘

æœ¬ä¾‹å¢åŠ çš„æ—¥å¿—æ‰“å°å¯¼èˆªå®ˆå«æ˜¯ä¸€ä¸ªå…¨å±€å‰ç½®å¯¼èˆªå®ˆå«ï¼Œå®ƒä¼šåœ¨ç”¨æˆ·è®¿é—®ä»»ä½•ä¸€ä¸ªè·¯å¾„æ—¶æ‰“å°ç”¨æˆ·è®¿é—®è·¯å¾„çš„æ—¥å¿—ï¼Œè¿™ç±»æ•°æ®å¯ä»¥é€šè¿‡åç«¯æ¥å£è®°å½•åœ¨æœåŠ¡å™¨ä¸­ï¼Œç”¨äºç”¨æˆ·çš„è¡Œä¸ºåˆ†æã€‚

ä»£ç ç¼–å†™åœ¨router:raw-latex:`\index`.jsæ–‡ä»¶ä¸­ï¼Œåœ¨åŸæ¥çš„è·¯ç”±ä»£ç ä¸‹å¢åŠ å¦‚ä¸‹ä»£ç ï¼š

::

   import { createRouter, createWebHistory } from 'vue-router'
   import HomeView from '../views/HomeView.vue'
   import HomeIndex from '@/views/HomeIndex'
   import UM from '@/views/UserMessage'
   import UD from '@/views/UserDetail'

   const routes = [
     {
       path: '/',
       name: 'home',
       component: HomeView
     },
     {
       path: '/about',
       name: 'about',
       // route level code-splitting
       // this generates a separate chunk (about.[hash].js) for this route
       // which is lazy-loaded when the route is visited.
       component: () => import(/* webpackChunkName: "about" */ '../views/AboutView.vue')
     },
     {
       path: '/user/:id',
       name: 'HomeIndex',
       component: HomeIndex,
       children: [
         { path: 'um', component: UM },
         { path: 'ud', component: UD }
       ]
     }
   ]

   const router = createRouter({
     history: createWebHistory(process.env.BASE_URL),
     routes
   })

   // å‰ç½®å¯¼èˆªå®ˆå«
   router.beforeEach((to, from, next) => {
     // æ‰“å°ç”¨æˆ·çš„ç›¸å…³èµ„æ–™
     console.log('ç”¨æˆ·å³å°†è¿›å…¥è·¯ç”±' + to.path)
     console.log('å½“å‰ç”¨æˆ·æ¥æº' + from.path)
     next()
   })
   export default router

ä»¥ä¸Šä»£ç é€šè¿‡router.beforeEach()åˆ›å»ºä¸€ä¸ªå…¨å±€å¯¼èˆªå®ˆå«ï¼Œå¹¶åœ¨æ‰€æœ‰çš„è·¯ç”±è¢«è®¿é—®æ—¶è°ƒç”¨è¯¥å®ˆå«ã€‚

.. image:: ../_static/image-20220301142229309.png
