<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>1.5. 字符串应用 &mdash; 运维开发修炼之路</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.6. 常量-恒定不变的值" href="06.%E5%B8%B8%E9%87%8F.html" />
    <link rel="prev" title="1.4. 变量声明周期" href="04.%E5%8F%98%E9%87%8F%E5%A3%B0%E6%98%8E%E5%91%A8%E6%9C%9F.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> 小健_Python_go_Devops
            <img src="../../_static/python_go.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Go语言学习</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">1. Go语言基本语法</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="01.%E5%A3%B0%E6%98%8E%E5%8F%98%E9%87%8F.html">1.1. 声明变量</a></li>
<li class="toctree-l3"><a class="reference internal" href="02.%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B.html">1.2. 数据类型</a></li>
<li class="toctree-l3"><a class="reference internal" href="03.%E6%8C%87%E9%92%88.html">1.3. 指针</a></li>
<li class="toctree-l3"><a class="reference internal" href="04.%E5%8F%98%E9%87%8F%E5%A3%B0%E6%98%8E%E5%91%A8%E6%9C%9F.html">1.4. 变量声明周期</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">1.5. 字符串应用</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id2">1.5.1. 1.计算字符串长度</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">1.5.2. 2.字符串拼接</a></li>
<li class="toctree-l4"><a class="reference internal" href="#string">1.5.3. 3.有关string的处理</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">1.5.4. 4.遍历字符串-获取每一个字符串元素</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">1.5.5. 5.获取字符串的某一段字符</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7">1.5.6. 6.修改字符串</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8">1.5.7. 7.格式化</a></li>
<li class="toctree-l4"><a class="reference internal" href="#base64">1.5.8. 8.Base64解码-电子邮件的基础解码格式</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ini">1.5.9. 9.从INI配置文件中查询需要的值</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id16">1.5.10. 10.字符串的常见操作</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="06.%E5%B8%B8%E9%87%8F.html">1.6. 常量-恒定不变的值</a></li>
<li class="toctree-l3"><a class="reference internal" href="07.%E7%B1%BB%E5%9E%8B%E5%88%AB%E5%90%8D.html">1.7. 类型别名</a></li>
<li class="toctree-l3"><a class="reference internal" href="08.%E7%BC%96%E8%AF%91%E4%B8%8E%E5%B7%A5%E5%85%B7.html">1.8. 编译与工具</a></li>
<li class="toctree-l3"><a class="reference internal" href="09.%E9%A1%B9%E7%9B%AE%E7%BB%84%E7%BB%87%E7%9A%84%E7%BB%93%E6%9E%84.html">1.9. 项目组织的结构</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../02.%E5%AE%B9%E5%99%A8-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/index.html">2. 容器-数据结构</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03.%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/index.html">3. 流程控制</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04.%E5%87%BD%E6%95%B0/index.html">4. 函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05.%E7%BB%93%E6%9E%84%E4%BD%93/index.html">5. 结构体</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06.%E6%8E%A5%E5%8F%A3/index.html">6. 接口</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07.%E5%8C%85/index.html">7. 包</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08.%E5%B9%B6%E5%8F%91/index.html">8. 并发</a></li>
<li class="toctree-l2"><a class="reference internal" href="../09.%E5%8F%8D%E5%B0%84/index.html">9. 反射</a></li>
<li class="toctree-l2"><a class="reference internal" href="../10.%E6%A0%87%E5%87%86%E5%BA%93%E5%92%8C%E4%B8%89%E6%96%B9%E5%BA%93/index.html">10. 标准库和三方库</a></li>
<li class="toctree-l2"><a class="reference internal" href="../11.%E9%A1%B9%E7%9B%AE%E4%BB%A3%E7%A0%81/index.html">11. 项目代码</a></li>
<li class="toctree-l2"><a class="reference internal" href="../12.%E9%81%BF%E5%9D%91%E4%B8%8E%E6%8A%80%E5%B7%A7/index.html">12. 避坑与技巧</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Go_vs_Python/index.html">Go vs Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Python/index.html">Python全栈系列</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Python%E6%B5%8B%E8%AF%95%E5%BC%80%E5%8F%91%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%9E%E8%B7%B5/index.html">Python测试开发入门与实践</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Vue/index.html">Vue.js企业开发实战</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Vue_Node.js/index.html">Vue.js+Node.js开发实战</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">小健_Python_go_Devops</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Go语言学习</a> &raquo;</li>
          <li><a href="index.html"><span class="section-number">1. </span>Go语言基本语法</a> &raquo;</li>
      <li><span class="section-number">1.5. </span>字符串应用</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/Go/01.Go语言基本语法/05.字符串应用.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#id1" id="id17">字符串应用</a></p>
<ul>
<li><p><a class="reference internal" href="#id2" id="id18">1.计算字符串长度</a></p></li>
<li><p><a class="reference internal" href="#id3" id="id19">2.字符串拼接</a></p>
<ul>
<li><p><a class="reference internal" href="#id4" id="id20">2.1 直接使用运算符</a></p></li>
<li><p><a class="reference internal" href="#bytes-buffer" id="id21">2.2 bytes.Buffer</a></p></li>
<li><p><a class="reference internal" href="#strings-builder" id="id22">2.3 strings.Builder</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#string" id="id23">3.有关string的处理</a></p></li>
<li><p><a class="reference internal" href="#id5" id="id24">4.遍历字符串-获取每一个字符串元素</a></p>
<ul>
<li><p><a class="reference internal" href="#ascii" id="id25">4.1遍历每一个ASCII字符</a></p></li>
<li><p><a class="reference internal" href="#unicode" id="id26">4.2 按Unicode字符遍历字符串</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id6" id="id27">5.获取字符串的某一段字符</a></p></li>
<li><p><a class="reference internal" href="#id7" id="id28">6.修改字符串</a></p></li>
<li><p><a class="reference internal" href="#id8" id="id29">7.格式化</a></p></li>
<li><p><a class="reference internal" href="#base64" id="id30">8.Base64解码-电子邮件的基础解码格式</a></p></li>
<li><p><a class="reference internal" href="#ini" id="id31">9.从INI配置文件中查询需要的值</a></p>
<ul>
<li><p><a class="reference internal" href="#id9" id="id32">1.INI文件的格式</a></p></li>
<li><p><a class="reference internal" href="#id10" id="id33">2.从INI文件中取值的函数</a></p></li>
<li><p><a class="reference internal" href="#id11" id="id34">3.读取文件</a></p></li>
<li><p><a class="reference internal" href="#id12" id="id35">4.读取行文本</a></p></li>
<li><p><a class="reference internal" href="#id13" id="id36">5.读取段</a></p></li>
<li><p><a class="reference internal" href="#id14" id="id37">6.读取键值</a></p></li>
<li><p><a class="reference internal" href="#id15" id="id38">7.完整代码示例</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id16" id="id39">10.字符串的常见操作</a></p></li>
</ul>
</li>
</ul>
</div>
<section id="id1">
<h1><a class="toc-backref" href="#id17"><span class="section-number">1.5. </span>字符串应用</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<section id="id2">
<h2><a class="toc-backref" href="#id18"><span class="section-number">1.5.1. </span>1.计算字符串长度</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>Go语言的内建函数len()，可以用来获取切片、字符串、通道（channel）等的长度。下面的代码可以用len()来获取字符串的长度。</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="nx">tip1</span> <span class="o">:=</span> <span class="s">&quot;genji is a ninja&quot;</span>
<span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nx">tip1</span><span class="p">))</span>

<span class="nx">tip2</span> <span class="o">:=</span> <span class="s">&quot;忍者&quot;</span>
<span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nx">tip2</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="s">&quot;fmt&quot;</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">tip1</span> <span class="o">:=</span> <span class="s">&quot;hujianli00001&quot;</span>

    <span class="nx">tip2</span> <span class="o">:=</span> <span class="s">&quot;hujianli02&quot;</span>
    <span class="nx">tip3</span> <span class="o">:=</span><span class="s">&quot;胡建力&quot;</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nx">tip1</span><span class="p">))</span>      <span class="c1">//13</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nx">tip2</span><span class="p">))</span>      <span class="c1">//10</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nx">tip3</span><span class="p">))</span>      <span class="c1">//9</span>
<span class="p">}</span>
</pre></div>
</div>
<p>每个中文占3个字节，中文len后结果为9.如果希望按照字符串个数进行计算，就要使用Go语言中的UTF-8包提供的RuneCountInString()函数，
统计Uncode字符数量。</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">utf8</span><span class="p">.</span><span class="nx">RuneCountInString</span><span class="p">(</span><span class="s">&quot;你好&quot;</span><span class="p">))</span>   <span class="c1">//2</span>
<span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">utf8</span><span class="p">.</span><span class="nx">RuneCountInString</span><span class="p">(</span><span class="s">&quot;你好，安河桥&quot;</span><span class="p">))</span>       <span class="c1">//6</span>
</pre></div>
</div>
<p>总结：</p>
<ul class="simple">
<li><p>ASCII字符串长度使用len()函数。</p></li>
<li><p>Unicode字符串长度使用utf8.RuneCountInString()函数。</p></li>
</ul>
</section>
<section id="id3">
<h2><a class="toc-backref" href="#id19"><span class="section-number">1.5.2. </span>2.字符串拼接</a><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<section id="id4">
<h3><a class="toc-backref" href="#id20">2.1 直接使用运算符</a><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="nx">str</span> <span class="o">:=</span> <span class="s">&quot;beijing wellcom to you&quot;</span> <span class="o">+</span> <span class="s">&quot;beibei jingjing huanhuan yy nini&quot;</span>
<span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">str</span><span class="p">)</span>

<span class="nx">s</span> <span class="o">:=</span> <span class="s">&quot;hello &quot;</span> <span class="o">+</span> <span class="s">&quot;hujianli&quot;</span>
<span class="nx">s</span> <span class="o">+=</span> <span class="s">&quot;study golang! &quot;</span>
<span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span>      <span class="c1">//hello hujianlistudy golang!</span>
</pre></div>
</div>
<ul class="simple">
<li><p>fmt.Sprintf()</p></li>
</ul>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="nx">ss</span> <span class="o">:=</span> <span class="nx">fmt</span><span class="p">.</span><span class="nx">Sprintf</span><span class="p">(</span><span class="s">&quot;%d %s&quot;</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="s">&quot;年&quot;</span><span class="p">)</span>
<span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">ss</span><span class="p">)</span>     <span class="c1">//2020 年</span>
</pre></div>
</div>
<ul class="simple">
<li><p>strings.Join()</p></li>
</ul>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="nx">hu</span> <span class="o">:=</span><span class="nx">strings</span><span class="p">.</span><span class="nx">Join</span><span class="p">([]</span><span class="kt">string</span><span class="p">{</span><span class="s">&quot;hello world&quot;</span><span class="p">,</span> <span class="s">&quot;hujianli&quot;</span><span class="p">},</span> <span class="s">&quot;,&quot;</span><span class="p">)</span>
<span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">hu</span><span class="p">)</span>     <span class="c1">//hello world,hujianli</span>
</pre></div>
</div>
</section>
<section id="bytes-buffer">
<h3><a class="toc-backref" href="#id21">2.2 bytes.Buffer</a><a class="headerlink" href="#bytes-buffer" title="Permalink to this headline">¶</a></h3>
<p>bytes.Buffer是可以缓冲并可以往里面写入各种字节数组的。字符串也是一种字节数组，使用WriteString()方法进行写入。</p>
<p>将需要连接的字符串，通过调用WriteString()方法，写入stringBuilder中，然后再通过stringBuilder.String()方法将缓冲转换为字符串。</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// 声明字节缓冲</span>
<span class="kd">var</span> <span class="nx">buffer</span> <span class="nx">bytes</span><span class="p">.</span><span class="nx">Buffer</span>
<span class="c1">// 把字符串写入缓冲</span>
<span class="nx">buffer</span><span class="p">.</span><span class="nx">WriteString</span><span class="p">(</span><span class="s">&quot;hello&quot;</span><span class="p">)</span>
<span class="nx">buffer</span><span class="p">.</span><span class="nx">WriteString</span><span class="p">(</span><span class="s">&quot;,&quot;</span><span class="p">)</span>
<span class="nx">buffer</span><span class="p">.</span><span class="nx">WriteString</span><span class="p">(</span><span class="s">&quot;world&quot;</span><span class="p">)</span>
<span class="c1">// 将缓冲以字符串形式输出</span>
<span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">buffer</span><span class="p">.</span><span class="nx">String</span><span class="p">())</span>        <span class="c1">//hello,world</span>
</pre></div>
</div>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&quot;bytes&quot;</span>
    <span class="s">&quot;fmt&quot;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">hammer</span> <span class="o">:=</span> <span class="s">&quot;吃我一锤&quot;</span>
    <span class="nx">sickle</span> <span class="o">:=</span> <span class="s">&quot;去死吧&quot;</span>

    <span class="c1">// 声明字节缓冲</span>
    <span class="kd">var</span> <span class="nx">stringBuilder</span> <span class="nx">bytes</span><span class="p">.</span><span class="nx">Buffer</span>

    <span class="c1">// 把字符串写入缓冲</span>
    <span class="nx">stringBuilder</span><span class="p">.</span><span class="nx">WriteString</span><span class="p">(</span><span class="nx">hammer</span><span class="p">)</span>
    <span class="nx">stringBuilder</span><span class="p">.</span><span class="nx">WriteString</span><span class="p">(</span><span class="nx">sickle</span><span class="p">)</span>

    <span class="c1">// 将缓冲以字符串形式输出</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">stringBuilder</span><span class="p">.</span><span class="nx">String</span><span class="p">())</span>

<span class="p">}</span>

<span class="c1">//吃我一锤去死吧</span>
</pre></div>
</div>
</section>
<section id="strings-builder">
<h3><a class="toc-backref" href="#id22">2.3 strings.Builder</a><a class="headerlink" href="#strings-builder" title="Permalink to this headline">¶</a></h3>
<p>strings.Builder 内部通过 slice 来保存和管理内容。slice
内部则是通过一个指针指向实际保存内容的数组。 strings.Builder
同样也提供了 Grow() 来支持预定义容量。
当我们可以预定义我们需要使用的容量时，strings.Builder
就能避免扩容而创建新的 slice 了。</p>
<p>strings.Builder是非线程安全，性能上和 bytes.Buffer 相差无几。</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">b1</span> <span class="nx">strings</span><span class="p">.</span><span class="nx">Builder</span>
<span class="nx">b1</span><span class="p">.</span><span class="nx">WriteString</span><span class="p">(</span><span class="s">&quot;ABC&quot;</span><span class="p">)</span>
<span class="nx">b1</span><span class="p">.</span><span class="nx">WriteString</span><span class="p">(</span><span class="s">&quot;DEF&quot;</span><span class="p">)</span>
<span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">b1</span><span class="p">.</span><span class="nx">String</span><span class="p">())</span>        <span class="c1">//ABCDEF</span>
</pre></div>
</div>
</section>
</section>
<section id="string">
<h2><a class="toc-backref" href="#id23"><span class="section-number">1.5.3. </span>3.有关string的处理</a><a class="headerlink" href="#string" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>strings 包提供了很多操作字符串的简单函数，通常一般的字符串操作需求都可以在这个包中找到。下面简单举几个例子：

判断是否以某字符串打头  strings.HasPrefix(s, prefix string) bool

判断是否以某字符串结尾  strings.HasSuffix(s, suffix string) bool

字符串分割 strings.Split(s, sep string) []string

返回子串索引 strings.Index(s, substr string) int strings.LastIndex 最后一个匹配索引

字符串连接 strings.Join(a []string, sep string) string 另外可以直接使用“+”来连接两个字符串

字符串替换 strings.Replace(s, old, new string, n int) string

字符串转化为大小写 strings.ToUpper(s string) string strings.ToLower(s string) string

统计某个字符在字符串出现的次数 strings.Count(s, substr string) int

判断字符串的包含关系 strings.Contains(s, substr string) bool
</pre></div>
</div>
</section>
<section id="id5">
<h2><a class="toc-backref" href="#id24"><span class="section-number">1.5.4. </span>4.遍历字符串-获取每一个字符串元素</a><a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<section id="ascii">
<h3><a class="toc-backref" href="#id25">4.1遍历每一个ASCII字符</a><a class="headerlink" href="#ascii" title="Permalink to this headline">¶</a></h3>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="s">&quot;fmt&quot;</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">theme</span> <span class="o">:=</span> <span class="s">&quot;狙击 start&quot;</span>

    <span class="k">for</span> <span class="nx">i</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="p">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="nx">theme</span><span class="p">);</span> <span class="nx">i</span><span class="o">++</span><span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;ascii: %c %d \n&quot;</span><span class="p">,</span><span class="nx">theme</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span><span class="nx">theme</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span>
    <span class="p">}</span>
<span class="p">}</span>



<span class="cm">/*ascii: ç 231</span>
<span class="cm">ascii:  139</span>
<span class="cm">ascii:  153</span>
<span class="cm">ascii: å 229</span>
<span class="cm">ascii:  135</span>
<span class="cm">ascii: » 187</span>
<span class="cm">ascii:   32</span>
<span class="cm">ascii: s 115</span>
<span class="cm">ascii: t 116</span>
<span class="cm">ascii: a 97</span>
<span class="cm">ascii: r 114</span>
<span class="cm">ascii: t 116 */</span>
</pre></div>
</div>
</section>
<section id="unicode">
<h3><a class="toc-backref" href="#id26">4.2 按Unicode字符遍历字符串</a><a class="headerlink" href="#unicode" title="Permalink to this headline">¶</a></h3>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="s">&quot;fmt&quot;</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">theme</span> <span class="o">:=</span> <span class="s">&quot;狙击 start&quot;</span>
    <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">s</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">theme</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;Unicode: %c %d\n&quot;</span><span class="p">,</span> <span class="nx">s</span><span class="p">,</span> <span class="nx">s</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="cm">/*Unicode: 狙 29401</span>
<span class="cm">Unicode: 击 20987</span>
<span class="cm">Unicode:   32</span>
<span class="cm">Unicode: s 115</span>
<span class="cm">Unicode: t 116</span>
<span class="cm">Unicode: a 97</span>
<span class="cm">Unicode: r 114</span>
<span class="cm">Unicode: t 116*/</span>
</pre></div>
</div>
<p>总结：</p>
<ul class="simple">
<li><p>ASCII字符串遍历直接使用下标。</p></li>
<li><p>Unicode字符串遍历用for range。</p></li>
</ul>
</section>
</section>
<section id="id6">
<h2><a class="toc-backref" href="#id27"><span class="section-number">1.5.5. </span>5.获取字符串的某一段字符</a><a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&quot;fmt&quot;</span>
    <span class="s">&quot;strings&quot;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">tracer</span> <span class="o">:=</span> <span class="s">&quot;死神来了,死神bye bye&quot;</span>
    <span class="nx">comma</span> <span class="o">:=</span> <span class="nx">strings</span><span class="p">.</span><span class="nx">Index</span><span class="p">(</span><span class="nx">tracer</span><span class="p">,</span> <span class="s">&quot;,&quot;</span><span class="p">)</span> <span class="c1">// 获取索引</span>
    <span class="c1">//fmt.Println(comma)</span>
    <span class="nx">pos</span> <span class="o">:=</span> <span class="nx">strings</span><span class="p">.</span><span class="nx">Index</span><span class="p">(</span><span class="nx">tracer</span><span class="p">[</span><span class="nx">comma</span><span class="p">:],</span> <span class="s">&quot;死神&quot;</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">comma</span><span class="p">,</span> <span class="nx">pos</span><span class="p">,</span> <span class="nx">tracer</span><span class="p">[</span><span class="nx">comma</span><span class="o">+</span><span class="nx">pos</span><span class="p">:])</span>
<span class="p">}</span>

<span class="c1">// 12 1 死神bye bye</span>
</pre></div>
</div>
<p>总结：</p>
<p>字符串索引比较常用的有如下几种方法。</p>
<ul class="simple">
<li><p>strings.Index：正向搜索子字符串。</p></li>
<li><p>strings.LastIndex：反向搜索子字符串。</p></li>
<li><p>搜索的起始位置可以通过切片偏移制作。</p></li>
</ul>
</section>
<section id="id7">
<h2><a class="toc-backref" href="#id28"><span class="section-number">1.5.6. </span>6.修改字符串</a><a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h2>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="s">&quot;fmt&quot;</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">ange1</span> <span class="o">:=</span> <span class="s">&quot;Heros never die&quot;</span>
    <span class="c1">// 将字符串转为字符串数组。</span>
    <span class="nx">angeleBytes</span> <span class="o">:=</span> <span class="p">[]</span> <span class="nb">byte</span><span class="p">(</span><span class="nx">ange1</span><span class="p">)</span>

    <span class="c1">// 利用循环，将never单词替换为空格。</span>
    <span class="k">for</span> <span class="nx">i</span> <span class="o">:=</span> <span class="mi">5</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">{</span>
        <span class="nx">angeleBytes</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="p">=</span> <span class="sc">&#39; &#39;</span>
    <span class="p">}</span>
    <span class="c1">// 使用string()将[]byte转为字符串时，重新创造了一个新的字符串。</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nb">string</span><span class="p">(</span><span class="nx">angeleBytes</span><span class="p">))</span>
<span class="p">}</span>

<span class="c1">// Heros       die</span>
</pre></div>
</div>
<p>GO语言中的字符串和其他高级语言（java C#）一样，默认是不可变的。</p>
<p>字符串不可变的好处有很多，如天生线程安全，大家使用的都是只读对象，无须加锁；
再者，方便内存共享，而不必使用写时复制等技术，字符串的hash值也只需要制作一份。</p>
<p>代码中实际修改的是[]byte，[]byte在Go语言中是可变的，本身就是一个切片。</p>
<p>完成对[]byte操作后，在使用string()将[]byte转为字符串时，重新创建一个新的字符串。</p>
<p>总结：</p>
<ul class="simple">
<li><p>Go语言的字符串是不可变的。</p></li>
<li><p>修改字符串时，可以将字符串转换为[]byte进行修改。</p></li>
<li><p>[]byte和string可以通过强制类型转换互转。</p></li>
</ul>
</section>
<section id="id8">
<h2><a class="toc-backref" href="#id29"><span class="section-number">1.5.7. </span>7.格式化</a><a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h2>
<p>格式化在逻辑中非常常用，使用格式化函数，要注意写法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>fmt.Sprintf(格式化样式，参数列表)
</pre></div>
</div>
<ul class="simple">
<li><p>格式化样式： 字符串形式，格式化动词以%开头。</p></li>
<li><p>参数列表：多个参数以逗号分隔，个数必须与格式化样式中的个数一一对应，否则运行时会报错。</p></li>
</ul>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="s">&quot;fmt&quot;</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">progress</span> <span class="p">=</span> <span class="mi">2</span>
    <span class="kd">var</span> <span class="nx">target</span> <span class="p">=</span> <span class="mi">8</span>
    <span class="nx">title</span> <span class="o">:=</span> <span class="nx">fmt</span><span class="p">.</span><span class="nx">Sprintf</span><span class="p">(</span><span class="s">&quot;已采集%d个草药，还需要%d个完成任务&quot;</span><span class="p">,</span> <span class="nx">progress</span><span class="p">,</span> <span class="nx">target</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">title</span><span class="p">)</span>
    <span class="nx">pi</span> <span class="o">:=</span> <span class="mf">3.14159</span>

    <span class="c1">// 按照数值本身的格式输出</span>
    <span class="nx">variant</span> <span class="o">:=</span> <span class="nx">fmt</span><span class="p">.</span><span class="nx">Sprintf</span><span class="p">(</span><span class="s">&quot;%v %v %v&quot;</span><span class="p">,</span> <span class="s">&quot;月球基地&quot;</span><span class="p">,</span> <span class="nx">pi</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">variant</span><span class="p">)</span>


    <span class="c1">// 匿名结构体声明，并赋予初值</span>
    <span class="nx">profile</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="kd">struct</span> <span class="p">{</span>
        <span class="nx">Name</span> <span class="kt">string</span>
        <span class="nx">HP</span>   <span class="kt">int</span>
    <span class="p">}{</span>
        <span class="nx">Name</span><span class="p">:</span> <span class="s">&quot;rat&quot;</span><span class="p">,</span>
        <span class="nx">HP</span><span class="p">:</span>   <span class="mi">150</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;使用&#39;%%+v&#39; %+v\n&quot;</span><span class="p">,</span> <span class="nx">profile</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;使用&#39;%%#v&#39; %#v\n&quot;</span><span class="p">,</span> <span class="nx">profile</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;使用&#39;%%T&#39; %T\n&quot;</span><span class="p">,</span> <span class="nx">profile</span><span class="p">)</span>
<span class="p">}</span>


<span class="cm">/*已采集2个草药，还需要8个完成任务</span>
<span class="cm">月球基地 3.14159 true</span>
<span class="cm">使用&#39;%+v&#39; &amp;{Name:rat HP:150}</span>
<span class="cm">使用&#39;%#v&#39; &amp;struct { Name string; HP int }{Name:&quot;rat&quot;, HP:150}</span>
<span class="cm">使用&#39;%T&#39; *struct { Name string; HP int }*/</span>
</pre></div>
</div>
<img alt="../../_images/go_format0001.png" src="../../_images/go_format0001.png" />
</section>
<section id="base64">
<h2><a class="toc-backref" href="#id30"><span class="section-number">1.5.8. </span>8.Base64解码-电子邮件的基础解码格式</a><a class="headerlink" href="#base64" title="Permalink to this headline">¶</a></h2>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&quot;encoding/base64&quot;</span>
    <span class="s">&quot;fmt&quot;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// 需要处理的字符串</span>
    <span class="nx">mesage</span> <span class="o">:=</span> <span class="s">&quot;Away from keyboard. https://goolang.org&quot;</span>

    <span class="c1">// 编码消息</span>
    <span class="nx">encodeMessage</span> <span class="o">:=</span> <span class="nx">base64</span><span class="p">.</span><span class="nx">StdEncoding</span><span class="p">.</span><span class="nx">EncodeToString</span><span class="p">([]</span><span class="nb">byte</span><span class="p">(</span><span class="nx">mesage</span><span class="p">))</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">encodeMessage</span><span class="p">)</span> <span class="c1">// 输出编码完成的消息</span>
    <span class="c1">//QXdheSBmcm9tIGtleWJvYXJkLiBodHRwczovL2dvb2xhbmcub3Jn</span>

    <span class="c1">//解码消息</span>
    <span class="nx">data</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">base64</span><span class="p">.</span><span class="nx">StdEncoding</span><span class="p">.</span><span class="nx">DecodeString</span><span class="p">(</span><span class="nx">encodeMessage</span><span class="p">)</span>
    <span class="c1">//出错处理</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="c1">// 打印解码完成的数据</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nb">string</span><span class="p">(</span><span class="nx">data</span><span class="p">))</span>           <span class="c1">//Away from keyboard. https://goolang.org</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="ini">
<h2><a class="toc-backref" href="#id31"><span class="section-number">1.5.9. </span>9.从INI配置文件中查询需要的值</a><a class="headerlink" href="#ini" title="Permalink to this headline">¶</a></h2>
<p>INI文件格式是一种古老的配置文件格式。一些操作系统、虚幻游戏引擎、GIT版本管理中都在使用INI文件格式。下面用从GIT版本管理的配置文件中截取的一部分内容，展示INI文件的样式。</p>
<section id="id9">
<h3><a class="toc-backref" href="#id32">1.INI文件的格式</a><a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">example.ini</span></code></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[core]</span>
<span class="na">repositoryformatversion</span> <span class="o">=</span> <span class="s">0</span>

<span class="na">filemode</span> <span class="o">=</span> <span class="s">false</span>
<span class="na">bare</span> <span class="o">=</span> <span class="s">false</span>
<span class="na">logallrefupdates</span> <span class="o">=</span> <span class="s">true</span>
<span class="na">symlinks</span> <span class="o">=</span> <span class="s">false</span>
<span class="na">ignorecase</span> <span class="o">=</span> <span class="s">true</span>
<span class="na">hideDotFiles</span> <span class="o">=</span> <span class="s">dotGitOnly</span>
<span class="k">[remote &quot;origin&quot;]</span>
<span class="na">url</span> <span class="o">=</span> <span class="s">https://github.com/davyxu/cellnet</span>
<span class="na">fetch</span> <span class="o">=</span> <span class="s">+refs/heads/*:refs/remotes/origin/*</span>
<span class="k">[branch &quot;master&quot;]</span>
<span class="na">remote</span> <span class="o">=</span> <span class="s">origin</span>
<span class="na">merge</span> <span class="o">=</span> <span class="s">refs/heads/master</span>
</pre></div>
</div>
</section>
<section id="id10">
<h3><a class="toc-backref" href="#id33">2.从INI文件中取值的函数</a><a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<p>getValue() 函数的声明如下：</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">getValue</span><span class="p">(</span><span class="nx">filename</span><span class="p">,</span> <span class="nx">expectSection</span><span class="p">,</span> <span class="nx">expectKey</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">string</span><span class="p">{}</span>
</pre></div>
</div>
<p>参数说明如下。 - filename：INI 文件的文件名。 -
expectSection：期望读取的段。 - expectKey：期望读取段中的键。</p>
<p>getValue()函数的实际使用例子参考代码如下：</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">getValue</span><span class="p">(</span><span class="s">&quot;example.ini&quot;</span><span class="p">,</span> <span class="s">&quot;remote \&quot;origin\&quot;&quot;</span><span class="p">,</span> <span class="s">&quot;fetch&quot;</span><span class="p">))</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">getValue</span><span class="p">(</span><span class="s">&quot;example.ini&quot;</span><span class="p">,</span> <span class="s">&quot;core&quot;</span><span class="p">,</span> <span class="s">&quot;hideDotFiles&quot;</span><span class="p">))</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id11">
<h3><a class="toc-backref" href="#id34">3.读取文件</a><a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<p>Go语言的os包中提供了文件打开函数os.Open()。文件读取完成后需要及时关闭，否则文件会发生占用，系统无法释放缓冲资源。参考下面代码：</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// 打开文件</span>
<span class="nx">file</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">os</span><span class="p">.</span><span class="nx">Open</span><span class="p">(</span><span class="nx">filename</span><span class="p">)</span>
<span class="c1">// 文件找不到返回空</span>
<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s">&quot;&quot;</span>
<span class="p">}</span>
<span class="c1">// 在函数结束时，关闭文件</span>
<span class="k">defer</span> <span class="nx">file</span><span class="p">.</span><span class="nx">Close</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="id12">
<h3><a class="toc-backref" href="#id35">4.读取行文本</a><a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h3>
<p>INI文件的格式是由多行文本组成，因此需要构造一个循环，不断地读取INI文件的所有行。
Go语言总是将文件以二进制格式打开，通过不同的读取方式对二进制文件进行操作。
Go语言对二进制读取有专门的代码抽象，bufio包即可以方便地以比较常见的方式读取二进制文件。</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="nx">reader</span> <span class="o">:=</span> <span class="nx">bufio</span><span class="p">.</span><span class="nx">NewReader</span><span class="p">(</span><span class="nx">file</span><span class="p">)</span>
<span class="c1">// 当前读取的段的名字</span>
<span class="kd">var</span> <span class="nx">sectionName</span> <span class="kt">string</span>
<span class="k">for</span> <span class="p">{</span>
    <span class="c1">// 读取文件的一行</span>
    <span class="c1">// 使用reader.ReadString()从文件中读取字符串，直到碰到“\n”，也就是行结束。这个函数返回读取到的行字符串（包括“\n”）和可能的读取错误err，例如文件读取完毕。</span>
    <span class="nx">linestr</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">reader</span><span class="p">.</span><span class="nx">ReadString</span><span class="p">(</span><span class="sc">&#39;\n&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="k">break</span>
    <span class="p">}</span>
    <span class="c1">// 切掉行的左右两边的空白字符</span>
    <span class="nx">linestr</span> <span class="p">=</span> <span class="nx">strings</span><span class="p">.</span><span class="nx">TrimSpace</span><span class="p">(</span><span class="nx">linestr</span><span class="p">)</span>
    <span class="c1">// 忽略空行</span>
    <span class="k">if</span> <span class="nx">linestr</span> <span class="o">==</span> <span class="s">&quot;&quot;</span> <span class="p">{</span>
        <span class="k">continue</span>
    <span class="p">}</span>
    <span class="c1">// 忽略注释</span>
    <span class="k">if</span> <span class="nx">linestr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;:&#39;</span> <span class="p">{</span>
        <span class="k">continue</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id13">
<h3><a class="toc-backref" href="#id36">5.读取段</a><a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h3>
<p>行字符串linestr已经去除了空白字符串，段的起止符又以“[” 开头，以
“]”结尾，因此可以直接判断行首和行尾的字符串匹配段的起止符匹配时读取的是段，</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// 行首和行尾分别是方括号的，说明是段标记的起止符</span>
<span class="k">if</span> <span class="nx">linestr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;[&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">linestr</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="nx">linestr</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;]&#39;</span> <span class="p">{</span>
    <span class="c1">// 将段名取出</span>
    <span class="nx">sectionName</span> <span class="p">=</span> <span class="nx">linestr</span><span class="p">[</span><span class="mi">1</span> <span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="nx">linestr</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1">// 这个段是希望读取的</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id14">
<h3><a class="toc-backref" href="#id37">6.读取键值</a><a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h3>
<p>这里代码紧接着前面的代码。当前行不是段时（不以“[”开头），那么行内容一定是键值对。别忘记此时getValue()的参数对段有匹配要求。找到能匹配段的键值对后，开始对键值对进行解析，参考下面的代码：</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="k">else</span> <span class="k">if</span> <span class="nx">sectionName</span> <span class="o">==</span> <span class="nx">expectSection</span> <span class="p">{</span>
            <span class="c1">//切开等号分割的键值对</span>
            <span class="nx">pair</span> <span class="o">:=</span> <span class="nx">strings</span><span class="p">.</span><span class="nx">Split</span><span class="p">(</span><span class="nx">linestr</span><span class="p">,</span> <span class="s">&quot;=&quot;</span><span class="p">)</span>
            <span class="c1">// 保证切开只有1个等号分割的简直情况</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">pair</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">{</span>
                <span class="c1">// 去掉键的多余空白字符</span>
                <span class="nx">key</span> <span class="o">:=</span> <span class="nx">strings</span><span class="p">.</span><span class="nx">TrimSpace</span><span class="p">(</span><span class="nx">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="c1">// 是期望的值</span>
                <span class="k">if</span> <span class="nx">key</span> <span class="o">==</span> <span class="nx">expectKey</span> <span class="p">{</span>
                    <span class="c1">// 返回去掉空白字符的值</span>
                    <span class="k">return</span> <span class="nx">strings</span><span class="p">.</span><span class="nx">TrimSpace</span><span class="p">(</span><span class="nx">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id15">
<h3><a class="toc-backref" href="#id38">7.完整代码示例</a><a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h3>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&quot;bufio&quot;</span>
    <span class="s">&quot;fmt&quot;</span>
    <span class="s">&quot;os&quot;</span>
    <span class="s">&quot;strings&quot;</span>
<span class="p">)</span>

<span class="c1">//根据文件名，段名，键名获取ini的值</span>
<span class="kd">func</span> <span class="nx">getValue</span><span class="p">(</span><span class="nx">filename</span><span class="p">,</span> <span class="nx">expectSection</span><span class="p">,</span> <span class="nx">expectKey</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
    <span class="c1">// 打开文件</span>
    <span class="nx">file</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">os</span><span class="p">.</span><span class="nx">Open</span><span class="p">(</span><span class="nx">filename</span><span class="p">)</span>
    <span class="c1">// 文件找不到返回空</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">&quot;&quot;</span>
    <span class="p">}</span>
    <span class="c1">// 在函数结束时，关闭文件</span>
    <span class="k">defer</span> <span class="nx">file</span><span class="p">.</span><span class="nx">Close</span><span class="p">()</span>

    <span class="c1">// 使用读取器读取文件</span>
    <span class="nx">reader</span> <span class="o">:=</span> <span class="nx">bufio</span><span class="p">.</span><span class="nx">NewReader</span><span class="p">(</span><span class="nx">file</span><span class="p">)</span>
    <span class="c1">// 当前读取的段的名字</span>
    <span class="kd">var</span> <span class="nx">sectionName</span> <span class="kt">string</span>
    <span class="k">for</span> <span class="p">{</span>
        <span class="c1">// 读取文件的一行</span>
        <span class="nx">linestr</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">reader</span><span class="p">.</span><span class="nx">ReadString</span><span class="p">(</span><span class="sc">&#39;\n&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
            <span class="k">break</span>
        <span class="p">}</span>
        <span class="c1">// 切掉行的左右两边的空白字符</span>
        <span class="nx">linestr</span> <span class="p">=</span> <span class="nx">strings</span><span class="p">.</span><span class="nx">TrimSpace</span><span class="p">(</span><span class="nx">linestr</span><span class="p">)</span>
        <span class="c1">// 忽略空行</span>
        <span class="k">if</span> <span class="nx">linestr</span> <span class="o">==</span> <span class="s">&quot;&quot;</span> <span class="p">{</span>
            <span class="k">continue</span>
        <span class="p">}</span>
        <span class="c1">// 忽略注释</span>
        <span class="k">if</span> <span class="nx">linestr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;:&#39;</span> <span class="p">{</span>
            <span class="k">continue</span>
        <span class="p">}</span>
        <span class="c1">// 行首和行尾分别是方括号的，说明是段标记的起止符</span>
        <span class="k">if</span> <span class="nx">linestr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;[&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">linestr</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="nx">linestr</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;]&#39;</span> <span class="p">{</span>
            <span class="c1">// 将段名取出</span>
            <span class="nx">sectionName</span> <span class="p">=</span> <span class="nx">linestr</span><span class="p">[</span><span class="mi">1</span> <span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="nx">linestr</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="c1">// 这个段是希望读取的</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="nx">sectionName</span> <span class="o">==</span> <span class="nx">expectSection</span> <span class="p">{</span>
            <span class="c1">//切开等号分割的键值对</span>
            <span class="nx">pair</span> <span class="o">:=</span> <span class="nx">strings</span><span class="p">.</span><span class="nx">Split</span><span class="p">(</span><span class="nx">linestr</span><span class="p">,</span> <span class="s">&quot;=&quot;</span><span class="p">)</span>
            <span class="c1">// 保证切开只有1个等号分割的简直情况</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">pair</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">{</span>
                <span class="c1">// 去掉键的多余空白字符</span>
                <span class="nx">key</span> <span class="o">:=</span> <span class="nx">strings</span><span class="p">.</span><span class="nx">TrimSpace</span><span class="p">(</span><span class="nx">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="c1">// 是期望的值</span>
                <span class="k">if</span> <span class="nx">key</span> <span class="o">==</span> <span class="nx">expectKey</span> <span class="p">{</span>
                    <span class="c1">// 返回去掉空白字符的值</span>
                    <span class="k">return</span> <span class="nx">strings</span><span class="p">.</span><span class="nx">TrimSpace</span><span class="p">(</span><span class="nx">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
    <span class="k">return</span> <span class="s">&quot;&quot;</span>

<span class="p">}</span>
<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">getValue</span><span class="p">(</span><span class="s">&quot;example.ini&quot;</span><span class="p">,</span> <span class="s">&quot;remote \&quot;origin\&quot;&quot;</span><span class="p">,</span> <span class="s">&quot;fetch&quot;</span><span class="p">))</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">getValue</span><span class="p">(</span><span class="s">&quot;example.ini&quot;</span><span class="p">,</span> <span class="s">&quot;core&quot;</span><span class="p">,</span> <span class="s">&quot;hideDotFiles&quot;</span><span class="p">))</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="id16">
<h2><a class="toc-backref" href="#id39"><span class="section-number">1.5.10. </span>10.字符串的常见操作</a><a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h2>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&quot;fmt&quot;</span>
    <span class="s">&quot;strings&quot;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">str0</span><span class="o">:=</span><span class="s">&quot;hujianli&quot;</span>
    <span class="nx">str1</span><span class="o">:=</span><span class="s">`第一行</span>
<span class="s">    第二行</span>
<span class="s">    第三行</span>
<span class="s">    `</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nx">str0</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="nx">str1</span><span class="p">))</span>        <span class="c1">//求长度</span>
    <span class="kd">var</span> <span class="nx">str3</span> <span class="kt">string</span> <span class="p">=</span> <span class="nx">str0</span> <span class="o">+</span> <span class="nx">str1</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">str3</span><span class="p">)</span>

    <span class="nx">str4</span> <span class="o">:=</span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Sprintf</span><span class="p">(</span><span class="s">&quot;%s %s&quot;</span><span class="p">,</span><span class="nx">str0</span><span class="p">,</span><span class="nx">str1</span><span class="p">)</span>   <span class="c1">//拼接字符串</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">str4</span><span class="p">)</span>

    <span class="nx">str5</span><span class="o">:=</span><span class="s">&quot;hu,jian,li&quot;</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">strings</span><span class="p">.</span><span class="nx">Split</span><span class="p">(</span><span class="nx">str5</span><span class="p">,</span><span class="s">&quot;,&quot;</span><span class="p">))</span>        <span class="c1">//分割</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">strings</span><span class="p">.</span><span class="nx">Split</span><span class="p">(</span><span class="nx">str5</span><span class="p">,</span><span class="s">&quot;i&quot;</span><span class="p">))</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;%q\n&quot;</span><span class="p">,</span> <span class="nx">strings</span><span class="p">.</span><span class="nx">Split</span><span class="p">(</span><span class="s">&quot; xyz &quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">))</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;%q\n&quot;</span><span class="p">,</span> <span class="nx">strings</span><span class="p">.</span><span class="nx">Split</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="s">&quot;Bernardo O&#39;Higgins&quot;</span><span class="p">))</span>

    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;%t\n&quot;</span><span class="p">,</span><span class="nx">strings</span><span class="p">.</span><span class="nx">Contains</span><span class="p">(</span><span class="s">&quot;sssss&quot;</span><span class="p">,</span><span class="s">&quot;ss&quot;</span><span class="p">))</span>       <span class="c1">//判断是否包含</span>

    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;%t\n&quot;</span><span class="p">,</span><span class="nx">strings</span><span class="p">.</span><span class="nx">HasPrefix</span><span class="p">(</span><span class="s">&quot;hujianli&quot;</span><span class="p">,</span><span class="s">&quot;hu&quot;</span><span class="p">))</span>   <span class="c1">//判断前缀</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;%t\n&quot;</span><span class="p">,</span><span class="nx">strings</span><span class="p">.</span><span class="nx">HasSuffix</span><span class="p">(</span><span class="s">&quot;hujianli&quot;</span><span class="p">,</span><span class="s">&quot;li&quot;</span><span class="p">))</span>   <span class="c1">//判断后缀</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;%d\n&quot;</span><span class="p">,</span><span class="nx">strings</span><span class="p">.</span><span class="nx">Index</span><span class="p">(</span><span class="s">&quot;hujianli&quot;</span><span class="p">,</span><span class="s">&quot;li&quot;</span><span class="p">))</span>   <span class="c1">//判断子串出现的位置</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;%d\n&quot;</span><span class="p">,</span><span class="nx">strings</span><span class="p">.</span><span class="nx">LastIndex</span><span class="p">(</span><span class="s">&quot;hujianli&quot;</span><span class="p">,</span><span class="s">&quot;i&quot;</span><span class="p">))</span>    <span class="c1">//判断子串最后出现的位置</span>
    <span class="nx">s</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">string</span><span class="p">{</span><span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="s">&quot;bar&quot;</span><span class="p">,</span> <span class="s">&quot;baz&quot;</span><span class="p">}</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">strings</span><span class="p">.</span><span class="nx">Join</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="s">&quot;,&quot;</span><span class="p">))</span>       <span class="c1">//将一系列字符串连接为一个字符串，之间用sep来分隔。</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="04.%E5%8F%98%E9%87%8F%E5%A3%B0%E6%98%8E%E5%91%A8%E6%9C%9F.html" class="btn btn-neutral float-left" title="1.4. 变量声明周期" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="06.%E5%B8%B8%E9%87%8F.html" class="btn btn-neutral float-right" title="1.6. 常量-恒定不变的值" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, huxiaojian.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>